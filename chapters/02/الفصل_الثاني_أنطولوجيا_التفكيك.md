# ุงููุตู ุงูุซุงูู: ุฃูุทูููุฌูุง ุงูุชูููู

## ูู ุชูููู ุงููุดููุงุช ุงููุนูุฏุฉ

---

## ููุฏูุฉ: ููุงุฐุง ุงูุชููููุ

> "ูู ูุดููุฉ ูุนูุฏุฉ ูู ูุฌููุนุฉ ูุดููุงุช ุจุณูุทุฉ ูุชุดุงุจูุฉ."

ูู ุนุงููู ูุชุณู ุจุงูุชุนููุฏ ุงููุชุฒุงูุฏุ ุฃุตุจุญุช ูุฏุฑุฉ ุงููููุฏุณ ุนูู ุงูุชูููู (Decomposition) ูู ุฃูู ุงูููุงุฑุงุช. ููุณ ูุฌุฑุฏ ุชูุณููุ ุจู **ููู ุงูุนูุงูุงุชุ ูุฑุคูุฉ ุงูุฃููุงุทุ ูุฅุนุงุฏุฉ ุงูุชุฑููุจ**.

ุงููุนูุงุฑู ุงูุฌูุฏ ูุง ููุงุฌู ุงูุชุนููุฏ ุจุงูุฅุฑูุงุจุ ุจู ุจู **ุงููุถูู**. ูุฑู ูู ุงููุชุงูุฉ ูุฑุตุฉ ูุงูุชุดุงู ุจููุฉ ุฌูููุฉ.

### ุงููุฑู ุจูู ุงูุชูุณูู ูุงูุชูููู

| ุงูุชูุณูู (Division) | ุงูุชูููู (Decomposition) |
|-------------------|------------------------|
| ูุทุน ุนุดูุงุฆู | ููู ุงูุนูุงูุงุช |
| ุชุฑุงูู ุงูุฃุฌุฒุงุก | ุชุฑุงุจุท ููุทูู |
| ูุฒูุฏ ุงูุชุนููุฏ | ููุดู ุงูุจุณุงุทุฉ |
| ุชููู ุจุญุช | ููุณูู ูุนููู |

### ูุตุฉ: ูุนูุงุฑู ุงูุจุฑูุฌูุงุช

ุชุฎูู ุฃูู ุชูู ุฃูุงู ูุงุชุฏุฑุงุฆูุฉ ุถุฎูุฉ. ุฃุนูุฏุฉุ ููุงูุฐุ ูุจุงุจุ ูููุด... ุชุจุฏู ูุนูุฏุฉ ุฌุฏุงู.

ููู ุงููุนูุงุฑู ูุฑู:
- **ุงููููู**: ุงูุฃุนูุฏุฉ ูุงูููุณุงุช
- **ุงููุธููุฉ**: ุงููุฏุฎูุ ุงูุตูุงุฉุ ุงููุจูุฉ
- **ุงูุฒุฎุฑูุฉ**: ุงูุชูุงุตูู ุงูุฌูุงููุฉ
- **ุงูุชูุงุฑุงุช**: ุญุฑูุฉ ุงููุงุณ ูุงูููุงุก ูุงูุถูุก

ูุฐุง ูู ุงูุชูููู.

---

## 2.1 ุฃุณุณ ุงูุชูููู ุงููุนูุงุฑู

### ุฃููุงู: ูุจุฏุฃ ุงูุชุฑุงุจุท ุงููุธููู (Functional Cohesion)

ูู ุฌุฒุก ูุฌุจ ุฃู ูููู ูุชูุงุณูุงู ูุธูููุงู. ุฃุฌุฒุงุก ุชุชุนุงูู ูุฃุฏุงุก ูููุฉ ูุงุญุฏุฉ ูุงุถุญุฉ.

**ูุซุงู ุฌูุฏ:**
```php
class InvoiceGenerator {
    public function generate(Order $order): Invoice {
        $items = $this->calculateItems($order);
        $totals = $this->calculateTotals($items);
        $taxes = $this->calculateTaxes($totals);
        
        return new Invoice($items, $totals, $taxes);
    }
    
    private function calculateItems(Order $order): array { /* ... */ }
    private function calculateTotals(array $items): Money { /* ... */ }
    private function calculateTaxes(Money $total): TaxBreakdown { /* ... */ }
}
```

ูู ุงูุฏูุงู ุชุฎุฏู ูุฏูุงู ูุงุญุฏุงู: ุฅูุดุงุก ูุงุชูุฑุฉ.

**ูุซุงู ุณูุก:**
```php
class Utils {
    public function generateInvoice($order) { /* ... */ }
    public function sendEmail($to, $subject, $body) { /* ... */ }
    public function calculateDistance($lat1, $lon1, $lat2, $lon2) { /* ... */ }
    public function formatDate($date) { /* ... */ }
}
```

ูุฐุง "ุณุทู ุงูููุงูุฉ" (God Class). ูู ุดูุก ููุง ุดูุก.

### ุซุงููุงู: ูุจุฏุฃ ุงูุนุฒู ุงููุนูููุงุชู (Information Hiding)

ุฃุฎูู ุงูุชูุงุตููุ ุงุนุฑุถ ุงููุงุฌูุฉ.

**ููุฑุฉ:** ูุฌุจ ุฃู ูููู ููุฌุฒุก "ุณุฑ" ูุญููู. ูุง ูุนุฑูู ุนู ููุณู ุฃูุซุฑ ููุง ููุดูู ููุนุงูู.

```php
class PaymentProcessor {
    private PaymentGateway $gateway;
    private FraudDetector $fraudDetector;
    private TransactionLogger $logger;
    
    public function process(PaymentRequest $request): PaymentResult {
        // ุงูุนููู ูุง ูุญุชุงุฌ ููุนุฑูุฉ ุงูุชูุงุตูู ุงูุฏุงุฎููุฉ
        $this->fraudDetector->validate($request);
        $result = $this->gateway->charge($request);
        $this->logger->record($result);
        
        return $result;
    }
}
```

ุงูุนููู ูุนุฑู ููุท: `process()` ูุนุงูุฌ ุงูุฏูุน.
ูุง ูุฑุงุก ุฐูู ูู "ุณุฑ" ุงููุงุฆู.

### ุซุงูุซุงู: ูุจุฏุฃ ุงูุงุณุชุจุฏุงู (Substitutability)

ูุฌุจ ุฃู ูุณุชุทูุน ุงุณุชุจุฏุงู ุฌุฒุก ุจุขุฎุฑ ูุชูุงูู ุฏูู ูุณุฑ ุงููุธุงู.

```php
interface NotificationSender {
    public function send(User $user, Notification $notification): void;
}

class EmailSender implements NotificationSender { /* ... */ }
class SmsSender implements NotificationSender { /* ... */ }
class PushNotificationSender implements NotificationSender { /* ... */ }

// ูููู ุงุณุชุจุฏุงู ุฃู ูููุง
class OrderService {
    public function __construct(
        private NotificationSender $notifier
    ) {}
}
```

---

## 2.2 ุงุณุชุฑุงุชูุฌูุงุช ุงูุชูููู

### ุงูุงุณุชุฑุงุชูุฌูุฉ 1: ุงูุชูููู ุงููุธููู (Functional Decomposition)

ุชูุณูู ุงููุธุงู ุจูุงุกู ุนูู **ูุง ููุนูู**.

**ูุซุงู: ูุธุงู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ**

```
ุงููุณุชูู ุงูุฃุนูู: ูุธุงู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ
โโโ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
โ   โโโ ุฅุถุงูุฉ ููุชุฌ
โ   โโโ ุชุญุฏูุซ ุงููุฎุฒูู
โ   โโโ ุงูุชุณุนูุฑ
โโโ ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
โ   โโโ ุฅูุดุงุก ุทูุจ
โ   โโโ ูุนุงูุฌุฉ ุงูุฏูุน
โ   โโโ ุงูุดุญู
โโโ ุฅุฏุงุฑุฉ ุงูุนููุงุก
โ   โโโ ุงูุชุณุฌูู
โ   โโโ ุงููุตุงุฏูุฉ
โ   โโโ ุงูููู ุงูุดุฎุตู
โโโ ุงูุชูุงุฑูุฑ
    โโโ ูุจูุนุงุช
    โโโ ุงููุฎุฒูู
```

**ูุชู ูุณุชุฎุฏููุงุ**
- ุนูุฏูุง ุงููุธุงุฆู ูุงุถุญุฉ ููุณุชููุฉ
- ุนูุฏูุง ูู ูุธููุฉ ุชุทูุฑ ูููุตู
- ูู ุงูุฃูุธูุฉ ูุชูุณุทุฉ ุงูุญุฌู

**ุชุญุฐูุฑ:**
ูุง ุชูุฑุท! ุชูููู ุฒุงุฆุฏ ูุคุฏู ุฅูู "ุงูููุถู ุงูููุฒุนุฉ".

### ุงูุงุณุชุฑุงุชูุฌูุฉ 2: ุงูุชูููู ุงููุฌุงูู (Domain Decomposition)

ุชูุณูู ุจูุงุกู ุนูู **ุงููุฌุงูุงุช** (Domains) ุฃู **ุงูุณูุงูุงุช** (Contexts).

**ูุซุงู: ูุธุงู ุจููู**

```
ุงููุธุงู ุงูุจููู
โโโ ุณูุงู ุงูุญุณุงุจุงุช (Account Context)
โ   โโโ ุฅูุดุงุก ุญุณุงุจ
โ   โโโ ุฅุบูุงู ุญุณุงุจ
โ   โโโ ุชุญุฏูุซ ุงูุจูุงูุงุช
โโโ ุณูุงู ุงููุนุงููุงุช (Transaction Context)
โ   โโโ ุงูุชุญููู
โ   โโโ ุงูุณุญุจ
โ   โโโ ุงูุฅูุฏุงุน
โโโ ุณูุงู ุงููุฑูุถ (Loan Context)
โ   โโโ ุทูุจ ูุฑุถ
โ   โโโ ุงูููุงููุฉ
โ   โโโ ุงูุณุฏุงุฏ
โโโ ุณูุงู ุงูุงูุชุซุงู (Compliance Context)
    โโโ ุงูุชุญูู ูู ุงููููุฉ
    โโโ ูุฑุงูุจุฉ ุงููุนุงููุงุช
```

**ูุชู ูุณุชุฎุฏููุงุ**
- ุฃูุธูุฉ ูุนูุฏุฉ ุฌุฏุงู
- ูุฑู ูุชุนุฏุฏุฉ ูุณุชููุฉ
- ุงุญุชูุงุฌุงุช ุชูุณุน ูุฎุชููุฉ

**ูุงุฆุฏุฉ:**
ูู ุณูุงู ูุบุชู ุงูุฎุงุตุฉุ ููุทูู ุงูุฎุงุตุ ูุฑููู ุงูุฎุงุต.

### ุงูุงุณุชุฑุงุชูุฌูุฉ 3: ุงูุชูููู ุงูุทุจูู (Layered Decomposition)

ุชูุณูู ุจูุงุกู ุนูู **ุงููุณุคูููุงุช ุงูุชูููุฉ**.

**ุงูุทุจูุงุช ุงูููุงุณูููุฉ:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   Presentation Layer            โ  โ ูุงุฌูุฉ ุงููุณุชุฎุฏู
โ   (Controllers, Views)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ   Application Layer             โ  โ ุชูุณูู ุงูุนูููุงุช
โ   (Use Cases, Services)         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ   Domain Layer                  โ  โ ููุทู ุงูุนูู
โ   (Entities, Value Objects)     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ   Infrastructure Layer          โ  โ ุงูุจููุฉ ุงูุชุญุชูุฉ
โ   (Database, External APIs)     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ:**
ุงูุชุจุนูุงุช ุชุชุฌู ููุฏุงุฎู.
ุงูู Domain ูุง ูุนุฑู ุดูุฆุงู ุนู Infrastructure.

**ููุฏ:**
```php
// Presentation Layer
class OrderController {
    public function __construct(
        private PlaceOrderUseCase $useCase
    ) {}
    
    public function store(Request $request): Response {
        $command = new PlaceOrderCommand(/* ... */);
        $result = $this->useCase->execute($command);
        return new JsonResponse($result);
    }
}

// Application Layer
class PlaceOrderUseCase {
    public function execute(PlaceOrderCommand $command): OrderResult {
        $order = Order::create(/* ... */);
        $this->orderRepository->save($order);
        $this->eventBus->publish($order->releaseEvents());
        return OrderResult::success($order->getId());
    }
}

// Domain Layer
class Order {
    public static function create(/* ... */): self {
        $order = new self();
        $order->recordEvent(new OrderCreated(/* ... */));
        return $order;
    }
}
```

### ุงูุงุณุชุฑุงุชูุฌูุฉ 4: ุงูุชูููู ุงููุญูุฑู (Aspect-Oriented Decomposition)

ุชูุณูู ุจูุงุกู ุนูู **ุงููุฎุงูู ุงููุชูุทุนุฉ** (Cross-Cutting Concerns).

**ุงููุฎุงูู ุงููุชูุทุนุฉ:**
- ุงูุชุณุฌูู (Logging)
- ุงููุตุงุฏูุฉ (Authentication)
- ุงููุฑุงุฌุนุฉ (Auditing)
- ุงูุชุฎุฒูู ุงููุคูุช (Caching)
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก (Error Handling)

**ุงููุดููุฉ:**
ูุฐู ุงููุฎุงูู ุชุธูุฑ ูู ูู ููุงู!

**ุงูุญู:**
ุนุฒููุง ูู "ุฌูุงูุจ" (Aspects) ูููุตูุฉ.

```php
// ุจุฏูู AOP
class OrderService {
    public function placeOrder($request) {
        $this->logger->info('Placing order', ['request' => $request]);
        
        try {
            if (!$this->auth->isAuthenticated()) {
                throw new UnauthorizedException();
            }
            
            $order = $this->createOrder($request);
            
            $this->audit->record('ORDER_PLACED', $order);
            $this->logger->info('Order placed', ['order_id' => $order->id]);
            
            return $order;
        } catch (Exception $e) {
            $this->logger->error('Order failed', ['error' => $e->getMessage()]);
            throw $e;
        }
    }
}

// ูุน AOP (ูููููู)
#[Logging]
#[Authenticated]
#[Auditable('ORDER_PLACED')]
class OrderService {
    public function placeOrder($request) {
        // ููุท ููุทู ุงูุนูู!
        return $this->createOrder($request);
    }
}
```

---

## 2.3 ููุงุฐุฌ ุงูุชูููู ุงูุดุงุฆุนุฉ

### ุงููููุฐุฌ 1: MVC (Model-View-Controller)

ุงููููุฐุฌ ุงูููุงุณูููุ ูุง ูุฒุงู ุตุงูุญุงู ููุงุณุชุฎุฏุงู.

```
โโโโโโโโโโโ     โโโโโโโโโโโโ     โโโโโโโโโโโ
โ  View   โ โโโ โ  Model   โ โโโ โControllerโ
โ (ุงููุงุฌูุฉ)โ     โ (ุงูุจูุงูุงุช)โ     โ(ุงูููุทู)  โ
โโโโโโฌโโโโโ     โโโโโโโโโโโโ     โโโโโโฌโโโโโ
     โ                                โ
     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              ุงููุณุชุฎุฏู
```

**ุงููุงุนุฏุฉ:**
- Model: ุงูุจูุงูุงุช ูุงูููุทู
- View: ุงูุนุฑุถ ููุท
- Controller: ุงูุชูุณูู ุจููููุง

**ูู Laravel:**
```php
// Model
class Product extends Model {
    protected $fillable = ['name', 'price', 'stock'];
    
    public function isInStock(): bool {
        return $this->stock > 0;
    }
}

// Controller
class ProductController extends Controller {
    public function show($id) {
        $product = Product::findOrFail($id);
        return view('products.show', compact('product'));
    }
}

// View (Blade)
@extends('layouts.app')
@section('content')
    <h1>{{ $product->name }}</h1>
    @if($product->isInStock())
        <button>ุฃุถู ููุณูุฉ</button>
    @else
        <span>ุบูุฑ ูุชููุฑ</span>
    @endif
@endsection
```

### ุงููููุฐุฌ 2: MVVM (Model-View-ViewModel)

ุดุงุฆุน ูู ุงูุชุทุจููุงุช ุงูุชูุงุนููุฉ.

```
Model โโ ViewModel โโ View
         (ุงูุญุงูุฉ    (ุงููุงุฌูุฉ
          ูุงูุฃูุงูุฑ)   ุงูุชูุงุนููุฉ)
```

**ุงูููุฑุฉ:**
ViewModel ุชุญุชูู ุนูู "ุงูุญุงูุฉ" (State) ู"ุงูุฃูุงูุฑ" (Commands).

### ุงููููุฐุฌ 3: Hexagonal Architecture (Ports & Adapters)

ูููุฐุฌ ูุณูุญ ุจุชุจุฏูู ุงูุชุจุนูุงุช ุจุณูููุฉ.

```
         โโโโโโโโโโโโโโโโโโโโโ
         โ   External World  โ
         โ  (Web, CLI, API)  โ
         โโโโโโโโโโโฌโโโโโโโโโโ
                   โ
         โโโโโโโโโโโผโโโโโโโโโโ
         โ     Adapters      โ
         โ  (Controllers,    โ
         โ   Presenters)     โ
         โโโโโโโโโโโฌโโโโโโโโโโ
                   โ
โโโโโโโโโโ โโโโโโโโโดโโโโโโโโโ โโโโโโโโโโ
โExternalโ โ   Application  โ โExternalโ
โServicesโ โ     Core       โ โServicesโ
โ (Email)โ โ   (Domain)     โ โ (DB)   โ
โโโโโโฌโโโโ โโโโโโโโโฌโโโโโโโโโ โโโโโฌโโโโโ
     โ             โ              โ
     โโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโ
           Ports (Interfaces)
```

**ุงูุชุทุจูู:**
```php
// Port (ูุงุฌูุฉ)
interface OrderRepository {
    public function save(Order $order): void;
    public function find(OrderId $id): ?Order;
}

// Adapter (ุชูููุฐ)
class EloquentOrderRepository implements OrderRepository {
    public function save(Order $order): void {
        OrderModel::fromDomain($order)->save();
    }
    
    public function find(OrderId $id): ?Order {
        $model = OrderModel::find($id->value());
        return $model?->toDomain();
    }
}

// ูููู ุงุณุชุจุฏุงูู ุจู:
class InMemoryOrderRepository implements OrderRepository {
    private array $orders = [];
    
    public function save(Order $order): void {
        $this->orders[$order->getId()->value()] = $order;
    }
    
    public function find(OrderId $id): ?Order {
        return $this->orders[$id->value()] ?? null;
    }
}
```

### ุงููููุฐุฌ 4: Clean Architecture

ูููุฐุฌ Robert C. Martin (Uncle Bob).

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           External Frameworks           โ
โ    (Laravel, Symfony, Database, Web)    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ           Interface Adapters            โ
โ      (Controllers, Presenters,          โ
โ       Gateways, External Interfaces)    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Use Cases (Application)         โ
โ     (Application Business Rules)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ          Entities (Enterprise)          โ
โ     (Enterprise Business Rules)         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
    Dependencies point inward
```

**ูุงุนุฏุฉ ุงูุงุนุชูุงุฏูุฉ:**
ุงูุทุจูุงุช ุงูุฎุงุฑุฌูุฉ ุชุนุชูุฏ ุนูู ุงูุฏุงุฎููุฉุ ูุง ุงูุนูุณ.

---

## 2.4 ุงูุชูููู ูู PHP: ุฏุฑุงุณุฉ ุนูููุฉ

### ุงูุณููุงุฑูู: ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงู (Task Management System)

#### ุงููุชุทูุจุงุช:
1. ุฅูุดุงุก ูููุฉ
2. ุชุนููู ูููุฉ ููุณุชุฎุฏู
3. ุฅููุงู ูููุฉ
4. ุชุชุจุน ุชุงุฑูุฎ ุงููููุฉ

#### ุงูุชุญููู:

**Bounded Contexts:**
```
Task Management System
โโโ Task Context (ุฅุฏุงุฑุฉ ุงูููุงู)
โโโ User Context (ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู)
โโโ Audit Context (ุงูุชุฏููู ูุงููุฑุงุฌุนุฉ)
```

**ุทุจูุงุช ุงูุชุทุจูู:**
```
Task Context
โโโ Domain Layer
โ   โโโ Task (Entity)
โ   โโโ TaskId (Value Object)
โ   โโโ TaskStatus (Value Object)
โ   โโโ TaskRepository (Interface)
โโโ Application Layer
โ   โโโ CreateTaskUseCase
โ   โโโ AssignTaskUseCase
โ   โโโ CompleteTaskUseCase
โโโ Infrastructure Layer
    โโโ EloquentTaskRepository
    โโโ TaskController
```

#### ุงูุชูููุฐ:

**1. Value Objects:**
```php
// src/Domain/Task/ValueObject/TaskId.php
final class TaskId {
    private function __construct(
        private string $value
    ) {
        Assert::uuid($value);
    }
    
    public static function generate(): self {
        return new self(Uuid::uuid4()->toString());
    }
    
    public static function fromString(string $value): self {
        return new self($value);
    }
    
    public function value(): string {
        return $this->value;
    }
    
    public function equals(self $other): bool {
        return $this->value === $other->value;
    }
}

// src/Domain/Task/ValueObject/TaskStatus.php
final class TaskStatus {
    private const PENDING = 'pending';
    private const ASSIGNED = 'assigned';
    private const COMPLETED = 'completed';
    
    private function __construct(
        private string $value
    ) {}
    
    public static function pending(): self {
        return new self(self::PENDING);
    }
    
    public static function assigned(): self {
        return new self(self::ASSIGNED);
    }
    
    public static function completed(): self {
        return new self(self::COMPLETED);
    }
    
    public function canTransitionTo(self $newStatus): bool {
        return match([$this->value, $newStatus->value]) {
            [self::PENDING, self::ASSIGNED] => true,
            [self::ASSIGNED, self::COMPLETED] => true,
            default => false,
        };
    }
}
```

**2. Entity:**
```php
// src/Domain/Task/Entity/Task.php
class Task {
    private array $events = [];
    
    private function __construct(
        private TaskId $id,
        private string $title,
        private string $description,
        private TaskStatus $status,
        private ?UserId $assignee = null
    ) {}
    
    public static function create(
        TaskId $id,
        string $title,
        string $description
    ): self {
        $task = new self(
            $id,
            $title,
            $description,
            TaskStatus::pending()
        );
        
        $task->recordEvent(new TaskCreated($id, $title));
        return $task;
    }
    
    public function assignTo(UserId $userId): void {
        if (!$this->status->canTransitionTo(TaskStatus::assigned())) {
            throw new InvalidStatusTransitionException();
        }
        
        $this->assignee = $userId;
        $this->status = TaskStatus::assigned();
        $this->recordEvent(new TaskAssigned($this->id, $userId));
    }
    
    public function complete(): void {
        if (!$this->status->canTransitionTo(TaskStatus::completed())) {
            throw new InvalidStatusTransitionException();
        }
        
        $this->status = TaskStatus::completed();
        $this->recordEvent(new TaskCompleted($this->id));
    }
    
    public function getId(): TaskId {
        return $this->id;
    }
    
    public function getStatus(): TaskStatus {
        return $this->status;
    }
    
    public function releaseEvents(): array {
        $events = $this->events;
        $this->events = [];
        return $events;
    }
    
    private function recordEvent(DomainEvent $event): void {
        $this->events[] = $event;
    }
}
```

**3. Repository Interface:**
```php
// src/Domain/Task/Repository/TaskRepository.php
interface TaskRepository {
    public function save(Task $task): void;
    public function find(TaskId $id): ?Task;
    public function findByAssignee(UserId $userId): array;
}
```

**4. Use Case:**
```php
// src/Application/UseCase/AssignTaskUseCase.php
class AssignTaskUseCase {
    public function __construct(
        private TaskRepository $taskRepository,
        private UserRepository $userRepository,
        private EventBus $eventBus
    ) {}
    
    public function execute(AssignTaskCommand $command): void {
        $task = $this->taskRepository->find($command->taskId);
        if (!$task) {
            throw new TaskNotFoundException();
        }
        
        $user = $this->userRepository->find($command->userId);
        if (!$user) {
            throw new UserNotFoundException();
        }
        
        $task->assignTo($command->userId);
        $this->taskRepository->save($task);
        
        foreach ($task->releaseEvents() as $event) {
            $this->eventBus->publish($event);
        }
    }
}

// src/Application/Command/AssignTaskCommand.php
class AssignTaskCommand {
    public function __construct(
        public readonly TaskId $taskId,
        public readonly UserId $userId
    ) {}
}
```

**5. Infrastructure (Eloquent):**
```php
// src/Infrastructure/Persistence/EloquentTaskRepository.php
class EloquentTaskRepository implements TaskRepository {
    public function save(Task $task): void {
        $model = TaskModel::updateOrCreate(
            ['id' => $task->getId()->value()],
            [
                'title' => $task->getTitle(),
                'status' => $task->getStatus()->value(),
                'assignee_id' => $task->getAssignee()?->value(),
            ]
        );
    }
    
    public function find(TaskId $id): ?Task {
        $model = TaskModel::find($id->value());
        return $model ? $this->toDomain($model) : null;
    }
    
    private function toDomain(TaskModel $model): Task {
        return Task::reconstitute(
            TaskId::fromString($model->id),
            $model->title,
            $model->description,
            TaskStatus::fromString($model->status),
            $model->assignee_id ? UserId::fromString($model->assignee_id) : null
        );
    }
}
```

**6. Controller:**
```php
// src/Infrastructure/Http/Controller/TaskController.php
class TaskController extends Controller {
    public function __construct(
        private CreateTaskUseCase $createTask,
        private AssignTaskUseCase $assignTask,
        private CompleteTaskUseCase $completeTask
    ) {}
    
    public function store(Request $request): JsonResponse {
        $command = new CreateTaskCommand(
            title: $request->input('title'),
            description: $request->input('description')
        );
        
        $result = $this->createTask->execute($command);
        
        return new JsonResponse([
            'id' => $result->taskId->value(),
            'message' => 'Task created successfully'
        ], 201);
    }
    
    public function assign(Request $request, string $taskId): JsonResponse {
        $command = new AssignTaskCommand(
            taskId: TaskId::fromString($taskId),
            userId: UserId::fromString($request->input('user_id'))
        );
        
        $this->assignTask->execute($command);
        
        return new JsonResponse(['message' => 'Task assigned']);
    }
}
```

---

*ูุชุจุน...*


---

## 2.5 ุฃููุงุท ุงูุชูููู ุงููุชูุฏูุฉ

### ุงูููุท 1: Strangler Fig Pattern

**ุงููุดููุฉ:**
ูุธุงู ูุฏูู ุถุฎู (Monolith) ูุญุชุงุฌ ููุงุณุชุจุฏุงูุ ููู ุฅุนุงุฏุฉ ุงููุชุงุจุฉ ุจุงููุงูู ุฎุทุฑุฉ.

**ุงูุญู:**
"ุฎูู" ุงููุธุงู ุงููุฏูู ุชุฏุฑูุฌูุงูุ ูุซู ูุจุชุฉ ุงูุชูู ุงูุชู ุชุฎูู ุงูุดุฌุฑุฉ ุงููุถููุฉ.

```
ุงููุฑุญูุฉ 1:              ุงููุฑุญูุฉ 2:              ุงููุฑุญูุฉ 3:
โโโโโโโโโโโโ           โโโโโโโโโโโโ           โโโโโโโโโโโโ
โ  Old     โ           โ  Old     โ           โ  New     โ
โ  System  โ โโโโโ     โ  System  โ โโโโโ     โ  System  โ
โ  (100%)  โ           โ  (70%)   โ           โ  (100%)  โ
โโโโโโโโโโโโ           โโโโโโฌโโโโโโ           โโโโโโโโโโโโ
                            โ
                       โโโโโโดโโโโโโ
                       โ  New     โ
                       โ  Service โ
                       โ  (30%)   โ
                       โโโโโโโโโโโโ
```

**ุงูุชูููุฐ:**

```php
// API Gateway ููุฌู ุจูุงุกู ุนูู ุงููุณุงุฑ
class RoutingGateway {
    public function handle(Request $request): Response {
        $path = $request->getPath();
        
        // ุงููุธุงุฆู ุงูุฌุฏูุฏุฉ ุชุฐูุจ ูููุธุงู ุงูุฌุฏูุฏ
        if (str_starts_with($path, '/api/v2/tasks')) {
            return $this->newSystem->handle($request);
        }
        
        // ุงูุจุงูู ูููุธุงู ุงููุฏูู
        return $this->legacySystem->handle($request);
    }
}
```

**ุงูุงุณุชุฑุงุชูุฌูุฉ:**
1. ุงุจุฏุฃ ุจุงููุธุงุฆู ุงูุฌุฏูุฏุฉ ููุท
2. ุงุณุชุฎุฑุฌ ุฎุฏูุงุช ุตุบูุฑุฉ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู
3. ุฃุบูู ุงููุธุงุฆู ุงููุฏููุฉ ุชุฏุฑูุฌูุงู
4. ุงุญุฐู ุงููุธุงู ุงููุฏูู ุนูุฏูุง ูุตุจุญ ูุงุฑุบุงู

**ูุฏุฉ:** 1-3 ุณููุงุช ูููุธุงู ุงููุจูุฑ.

### ุงูููุท 2: Anti-Corruption Layer (ACL)

**ุงููุดููุฉ:**
ูุธุงูุงู ูุฎุชููุงู ูุญุชุงุฌุงู ููุชูุงุตูุ ููู ุฃุญุฏููุง ูุฏูู/ุฑุฏูุก.

**ุงูุญู:**
ุทุจูุฉ ุชุฑุฌูุฉ ุชุญูู ุงููุธุงู ุงูุฌุฏูุฏ ูู "ูุณุงุฏ" ุงููุธุงู ุงููุฏูู.

```
โโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโ
โ   New System โ โโโโ โ Anti-Corruption  โ โโโโ โ Legacy Systemโ
โ   (ูุธูู)     โ      โ Layer (ุชุฑุฌูุฉ)    โ      โ (ูุฏูู)       โ
โโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ      โโโโโโโโโโโโโโโโ
```

**ุงูุชูููุฐ:**

```php
// ุงููุงุฌูุฉ ุงูุชู ูุฑูุฏูุง
interface CustomerRepository {
    public function findById(CustomerId $id): ?Customer;
}

// ุงููุธุงู ุงููุฏูู ูุนูุฏ array
class LegacyCustomerRepository {
    public function get_customer_data(int $id): array {
        // ูุงุนุฏุฉ ุจูุงูุงุช ูุฏููุฉุ ุฃุณูุงุก ุญููู ุบุฑูุจุฉ
        return [
            'cust_id' => $id,
            'cust_name' => '...',
            'cust_addr' => '...',
            'cust_status_cd' => 'A'
        ];
    }
}

// ุงูู ACL ูุชุฑุฌู
class CustomerRepositoryAdapter implements CustomerRepository {
    public function __construct(
        private LegacyCustomerRepository $legacy
    ) {}
    
    public function findById(CustomerId $id): ?Customer {
        $data = $this->legacy->get_customer_data($id->toInt());
        
        if (empty($data)) {
            return null;
        }
        
        // ุชุฑุฌูุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ ูููููุฐุฌ ุงูุฌุฏูุฏ
        return new Customer(
            id: CustomerId::fromInt($data['cust_id']),
            name: new Name($data['cust_name']),
            address: $this->parseAddress($data['cust_addr']),
            status: $this->mapStatus($data['cust_status_cd'])
        );
    }
    
    private function mapStatus(string $code): CustomerStatus {
        return match($code) {
            'A' => CustomerStatus::active(),
            'I' => CustomerStatus::inactive(),
            default => CustomerStatus::unknown()
        };
    }
}
```

**ูุงุฆุฏุฉ:**
- ุงููุธุงู ุงูุฌุฏูุฏ ูุธูู ูููู
- ุงูุชุบููุฑุงุช ูู ุงููุธุงู ุงููุฏูู ูุง ุชุคุซุฑ ุนูููุง
- ูููููุง ุงุณุชุจุฏุงู ุงููุธุงู ุงููุฏูู ูุงุญูุงู ุจุณูููุฉ

### ุงูููุท 3: Saga Pattern

**ุงููุดููุฉ:**
ุนูููุฉ ุชูุทูู ุนูู ุนุฏุฉ ุฎุฏูุงุชุ ููุฑูุฏ ุชูููุฐูุง ุจุฃูุงู.

**ุงูุญู:**
ุชูุณูู ุงููุนุงููุงุช ุนุจุฑ ุงูุฎุฏูุงุช ุจุงุณุชุฎุฏุงู Saga (ูุตุฉ/ุฑูุงูุฉ).

**ููุนุงู:**

**1. Choreography (ุงูุฑูุตุฉ):**
ูู ุฎุฏูุฉ ุชูููู ุนูููุง ูุชูุนูู ุงูุชุงููุฉ.

```
Order Service โ Payment Service โ Inventory Service โ Shipping Service
     โ                โ                  โ                    โ
   Order          Payment            Reserved              Shipped
   Created        Processed          Inventory
```

**2. Orchestration (ุงูููุงุฏุฉ):**
ุฎุฏูุฉ ูุฑูุฒูุฉ ุชูุณู ุงููู.

```
                    โโโโโโโโโโโโโโโโโโโโ
                    โ Saga Orchestratorโ
                    โโโโโโโโโโฌโโโโโโโโโโ
                             โ
        โโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโ
        โ                    โ                    โ
โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ
โ   Order      โ   โ   Payment    โ   โ  Inventory   โ
โ   Service    โ   โ   Service    โ   โ   Service    โ
โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโ
```

**ุงูุชูููุฐ:**

```php
// Orchestrator
class OrderSaga {
    public function __construct(
        private OrderService $orderService,
        private PaymentService $paymentService,
        private InventoryService $inventoryService,
        private SagaLog $log
    ) {}
    
    public function execute(CreateOrderCommand $command): SagaResult {
        $sagaId = $this->log->startSaga($command);
        
        try {
            // ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุงูุทูุจ
            $order = $this->orderService->createOrder($command);
            $this->log->recordStep($sagaId, 'ORDER_CREATED', $order->getId());
            
            // ุงูุฎุทูุฉ 2: ูุนุงูุฌุฉ ุงูุฏูุน
            $payment = $this->paymentService->processPayment(
                $order->getId(),
                $order->getTotal()
            );
            $this->log->recordStep($sagaId, 'PAYMENT_PROCESSED', $payment->getId());
            
            // ุงูุฎุทูุฉ 3: ุญุฌุฒ ุงููุฎุฒูู
            $this->inventoryService->reserveItems($order->getItems());
            $this->log->recordStep($sagaId, 'INVENTORY_RESERVED');
            
            $this->log->completeSaga($sagaId);
            return SagaResult::success($order);
            
        } catch (Exception $e) {
            // ุงูุชุฑุงุฌุน ุนู ุงูุฎุทูุงุช ุงูุณุงุจูุฉ
            $this->compensate($sagaId);
            return SagaResult::failure($e);
        }
    }
    
    private function compensate(string $sagaId): void {
        $steps = $this->log->getSteps($sagaId);
        
        // ุงูุชุฑุงุฌุน ุจุงูุนูุณ
        foreach (array_reverse($steps) as $step) {
            match($step->getName()) {
                'INVENTORY_RESERVED' => $this->inventoryService->releaseReservation($step->getData()),
                'PAYMENT_PROCESSED' => $this->paymentService->refund($step->getData()),
                'ORDER_CREATED' => $this->orderService->cancelOrder($step->getData()),
            };
        }
    }
}
```

### ุงูููุท 4: CQRS (ูุฑุงุฌุนุฉ ุณุฑูุนุฉ)

ูุตู ุฃูุงูุฑ ุงููุชุงุจุฉ ุนู ุงุณุชุนูุงูุงุช ุงููุฑุงุกุฉ.

```php
// Command Side
class CreateOrderHandler {
    public function handle(CreateOrderCommand $command): void {
        $order = Order::create($command);
        $this->orderRepository->save($order);
        $this->eventBus->publish(new OrderCreated($order));
    }
}

// Query Side (ูููุฐุฌ ููุญุณููู ูููุฑุงุกุฉ)
class OrderSummaryProjection {
    public function handle(OrderCreated $event): void {
        // ุชุญุฏูุซ ูููุฐุฌ ุงููุฑุงุกุฉ ูุจุงุดุฑุฉ
        DB::table('order_summaries')->insert([
            'order_id' => $event->orderId,
            'customer_name' => $event->customerName,
            'total_amount' => $event->total->amount(),
            'status' => 'pending',
            'created_at' => now()
        ]);
    }
}

// Query Handler
class GetOrderSummaryHandler {
    public function handle(GetOrderSummaryQuery $query): ?OrderSummary {
        return DB::table('order_summaries')
            ->where('order_id', $query->orderId)
            ->first();
    }
}
```

**ูุงุฆุฏุฉ:**
- ููุงุฐุฌ ุงููุฑุงุกุฉ ููุญุณูููุฉ ููุงุณุชุนูุงูุงุช
- ูุง ุนูุงูุงุช ูุนูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูููุฑุงุกุฉ
- ูููู ุชูุณูุน ุงููุฑุงุกุฉ ุจุดูู ูุณุชูู

---

## 2.6 ุฏุฑุงุณุฉ ุญุงูุฉ: ุชูููู ูุธุงู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ

### ุงูุฎูููุฉ

**ุงููุธุงู:**
- ุนูุฑ: 8 ุณููุงุช
- ูุบุฉ: PHP (Laravel)
- ูุงุนุฏุฉ ุจูุงูุงุช: MySQL ูุงุญุฏุฉ
- ุงูุญุฌู: 200,000 ุณุทุฑ ููุฏ
- ุงููุฑูู: 15 ูุทูุฑ

**ุงููุดุงูู:**
1. ุชุบููุฑ ุจุณูุท ููุณุฑ 3 ุฃูุงูู ุฃุฎุฑู
2. ูุดุฑ ุฌุฏูุฏ ูุญุชุงุฌ 6 ุณุงุนุงุช ูู ุงูุงุฎุชุจุงุฑุงุช
3. ูุงุนุฏุฉ ุงูุจูุงูุงุช 2TBุ ุตุนุจุฉ ุงูุชูุณุน
4. ูุง ุฃุญุฏ ูููู ุงููุธุงู ูุงููุงู

### ุงูุชุญููู ุงูุฃููู

**ุฑุณู ุฎุฑูุทุฉ ุงููุธุงู:**

```
E-commerce Monolith
โโโ Product Management (30k lines)
โ   โโโ Catalog
โ   โโโ Inventory
โ   โโโ Pricing
โโโ Order Management (50k lines)
โ   โโโ Cart
โ   โโโ Checkout
โ   โโโ Order Processing
โโโ Customer Management (25k lines)
โ   โโโ Profiles
โ   โโโ Authentication
โ   โโโ Preferences
โโโ Payment Processing (40k lines)
โ   โโโ Gateways
โ   โโโ Refunds
โ   โโโ Fraud Detection
โโโ Shipping (35k lines)
โ   โโโ Carriers
โ   โโโ Tracking
โ   โโโ Returns
โโโ Reporting (20k lines)
    โโโ Sales Reports
    โโโ Analytics
```

**ุชุญุฏูุฏ ุงูุงุฑุชุจุงุทุงุช:**

```
Product โโโ Inventory โโโ Order โโโ Payment โโโ Shipping
   โ           โ            โ           โ            โ
 Pricing   Stock Level   Total    Transaction   Tracking
```

### ุงุณุชุฑุงุชูุฌูุฉ ุงูุชูููู

**ุงููุฑุญูุฉ 1: ุนุฒู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุงูุดููุฑ 1-6)**

1. ุฅูุดุงุก views ูููุตูุฉ ููู ุณูุงู
2. ููู ุงูุฌุฏุงูู ุงููุดุชุฑูุฉ ูููุงุนุฏ ูููุตูุฉ
3. ุงุณุชุฎุฏุงู API ููุชูุงุตู ุจุฏูุงู ูู JOIN

```sql
-- ูุจู
SELECT o.*, p.name, p.price, c.name as customer_name
FROM orders o
JOIN products p ON o.product_id = p.id
JOIN customers c ON o.customer_id = c.id;

-- ุจุนุฏ (ูู Order Service)
SELECT * FROM orders WHERE ...;
// ุซู ุงุณุชุฏุนุงุก APIs
$product = $productService->getProduct($order->product_id);
$customer = $customerService->getCustomer($order->customer_id);
```

**ุงููุฑุญูุฉ 2: ุงุณุชุฎุฑุงุฌ ุฃูู ุฎุฏูุฉ (ุงูุดููุฑ 6-12)**

ุงุฎุชุฑูุง **Payment Service** ุฃููุงู:
- ูุงุถุญ ุงูุญุฏูุฏ
- ุงุญุชูุงุฌุงุช ุฃูุงู ุนุงููุฉ
- ูุฑูู ูุชุฎุตุต ููุฌูุฏ

```
Before:                    After:
โโโโโโโโโโโโโโโโ          โโโโโโโโโโโโโโโโ
โ  Monolith    โ          โ  Monolith    โ
โ              โ          โ   (ุจุฏูู      โ
โ  โโโโโโโโโโ  โ          โ    payment)  โ
โ  โPayment โ  โ    โ     โโโโโโโโฌโโโโโโโโ
โ  โ  (40k) โ  โ                 โ
โ  โโโโโโโโโโ  โ          โโโโโโโโผโโโโโโโโ
โ              โ          โPayment       โ
โโโโโโโโโโโโโโโโ          โ Service      โ
                          โ (ุฌุฏูุฏ)       โ
                          โโโโโโโโโโโโโโโโ
```

**Anti-Corruption Layer:**

```php
class PaymentGatewayAdapter {
    public function __construct(
        private PaymentServiceClient $paymentService
    ) {}
    
    public function processPayment(
        MonolithOrder $order,
        MonolithPaymentMethod $method
    ): MonolithPaymentResult {
        // ุชุฑุฌูุฉ ูู ูููุฐุฌ Monolith ููููุฐุฌ Service
        $request = new PaymentRequest(
            amount: new Money($order->getTotal(), $order->getCurrency()),
            method: $this->translatePaymentMethod($method),
            metadata: [
                'legacy_order_id' => $order->getId(),
                'source' => 'monolith'
            ]
        );
        
        $result = $this->paymentService->process($request);
        
        // ุชุฑุฌูุฉ ุงููุชูุฌุฉ ูููููุฐุฌ ุงููุฏูู
        return new MonolithPaymentResult(
            success: $result->isSuccessful(),
            transactionId: $result->getTransactionId(),
            errorCode: $result->getErrorCode()
        );
    }
}
```

**ุงููุฑุญูุฉ 3: ุงูุงุณุชูุฑุงุฑ (ุงูุณูุฉ 2-3)**

ุงุณุชุฎุฑุฌูุง ุจุงูุชุฑุชูุจ:
1. โ Payment (ุชู)
2. ๐ Inventory (ุฌุงุฑู)
3. โณ Shipping (ูุฎุทุท)
4. โณ Customer (ูุฎุทุท)
5. โณ Product (ูุฎุทุท)

### ุงููุชุงุฆุฌ ุจุนุฏ 3 ุณููุงุช

**ูุจู:**
- ูุดุฑ: 6 ุณุงุนุงุช
- ูุนุฏู ุงูุฃุฎุทุงุก: 5/ูุดุฑ
- ุชุบููุฑ ุจุณูุท: 2-3 ุฃูุงู

**ุจุนุฏ:**
- ูุณุจุฉ ุงูุฃุฎุทุงุก: 0.5/ูุดุฑ
- ุชุบููุฑ ูู Payment: 2-4 ุณุงุนุงุช (ูุณุชูู)
- ุชุบููุฑ ูู Monolith: 1-2 ุฃูุงู (ุฃุตุบุฑ)

**ุงูุชูููุฉ:**
- 3 ุณููุงุช ูู ุงูุนูู
- ูุฑูู grew ูู 15 ูู 25
- ุจููุฉ ุชุญุชูุฉ ุฃุนูุฏ

**ุงููุงุฆุฏุฉ:**
- ุณุฑุนุฉ ุงูุชุทููุฑ ุชุถุงุนูุช
- ูุงุจููุฉ ุงูุชูุณุน
- ูุฑู ูุณุชููุฉ

---

## 2.7 ุงุฎุชุจุงุฑ ุงูุฃูุธูุฉ ุงููููููุฉ

### ุงูุชุญุฏูุงุช

**1. ุงูุงุฎุชุจุงุฑ ุงููุชูุงูู:**
ููู ูุฎุชุจุฑ ุนุฏุฉ ุฎุฏูุงุช ูุนุงูุ

**2. ุงูู Mocking:**
ูุชู ูุณุชุฎุฏู mocks ููุชู ูุณุชุฎุฏู ุงูุฎุฏูุงุช ุงูุญููููุฉุ

**3. ุงูุจูุงูุงุช:**
ููู ูุถูู ุงุชุณุงู ุงูุจูุงูุงุช ุจูู ุงูุฎุฏูุงุชุ

### ุงุณุชุฑุงุชูุฌูุงุช

**1. Consumer-Driven Contracts (CDC)**

ุงูุฎุฏูุฉ ุงููุณุชูููุฉ ุชุญุฏุฏ ูุง ุชุชููุนู ูู ุงููุฒูุฏ.

```php
// ูู Order Service (ุงููุณุชููู)
class PaymentServiceContractTest {
    public function test_payment_service_returns_transaction_id() {
        $response = $this->paymentClient->process([
            'amount' => 100,
            'currency' => 'USD'
        ]);
        
        // ูุฐุง ูุง ูุชููุนู
        $this->assertArrayHasKey('transaction_id', $response);
        $this->assertArrayHasKey('status', $response);
        $this->assertMatchesPattern('/^TXN-[0-9]+$/', $response['transaction_id']);
    }
}
```

ูุชู ุชุดุบูู ูุฐุง ุงูุงุฎุชุจุงุฑ ุถุฏ Payment Service ููุชุฃูุฏ ูู ุฃู ุงูุนูุฏ ูุญุชุฑู.

**2. Contract Testing with Pact**

ุฃุฏุงุฉ ุชููุดุฆ ุนููุฏุงู ุจูู ุงูุฎุฏูุงุช.

```php
// Order Service ูููุดุฆ ุนูุฏ
$pact = new PactBuilder();
$pact
    ->given('payment gateway is available')
    ->uponReceiving('a request to process payment')
    ->with([
        'method' => 'POST',
        'path' => '/payments',
        'body' => [
            'amount' => 100,
            'currency' => 'USD'
        ]
    ])
    ->willRespondWith([
        'status' => 200,
        'body' => [
            'transaction_id' => Pact::like('TXN-12345'),
            'status' => 'success'
        ]
    ]);
```

**3. Integration Testing**

```php
class OrderIntegrationTest {
    public function test_complete_order_flow() {
        // ุฅุนุฏุงุฏ
        $product = $this->createProduct(['price' => 100, 'stock' => 10]);
        $customer = $this->createCustomer();
        
        // ุงูุชูููุฐ
        $order = $this->orderService->createOrder([
            'customer_id' => $customer->id,
            'items' => [['product_id' => $product->id, 'quantity' => 2]]
        ]);
        
        $this->paymentService->processPayment($order->id, 'valid-card');
        
        // ุงูุชุญูู
        $this->assertDatabaseHas('orders', [
            'id' => $order->id,
            'status' => 'paid'
        ]);
        
        $this->assertDatabaseHas('inventory', [
            'product_id' => $product->id,
            'stock' => 8 // 10 - 2
        ]);
    }
}
```

**4. End-to-End Testing**

```php
class E2EOrderTest {
    public function test_user_can_complete_purchase() {
        // ูุญุงูุงุฉ ูุชุตูุญ ุญูููู
        $browser = new Browser();
        
        $browser->visit('/products/1')
            ->click('Add to Cart')
            ->click('Checkout')
            ->fill('email', 'test@example.com')
            ->fill('card_number', '4242424242424242')
            ->click('Pay')
            ->see('Thank you for your order!');
        
        // ุงูุชุญูู ูู ููุงุนุฏ ุงูุจูุงูุงุช
        $this->assertOrderCreatedInOrderService();
        $this->assertPaymentRecordedInPaymentService();
        $this->assertInventoryUpdatedInInventoryService();
    }
}
```

---

## 2.8 ููุณูุฉ ุงูุชูููู

### ุงูุชุนููุฏ ุงูุถุฑูุฑู vs ุงูุชุนููุฏ ุงูุนุฑุถู

**ุงูุชุนููุฏ ุงูุถุฑูุฑู (Essential Complexity):**
ุงูุตุนูุจุฉ ุงูู inherent ูู ุงููุดููุฉ ููุณูุง.

**ุงูุชุนููุฏ ุงูุนุฑุถู (Accidental Complexity):**
ุงูุตุนูุจุฉ ุงูุชู ููุถูููุง ุจุณูุก ุงูุชุตููู.

**ูุฏู ุงููุนูุงุฑู:**
ุชูููู ุงูุชุนููุฏ ุงูุนุฑุถู ุฅูู ุงูุตูุฑุ ูุงูุชุนุงูู ูุน ุงูุถุฑูุฑู ุจุฃูุงูุฉ.

### ูุจุฏุฃ "ุงูุจุณุงุทุฉ ูู ุงูุทุฑููู"

> "Everything should be made as simple as possible, but not simpler." - Einstein

**ุงูุชุทุจูู:**
- ุงูููุงุฉ ุจุณูุทุฉ ููููุฉ
- ุงููุงุฌูุงุช ุจุณูุทุฉ ููุงุถุญุฉ
- ุงูุฌุณุฑ ุจููููุง (ุงูุทุจูุงุช ุงููุณุทู) ูุฏ ูููู ูุนูุฏุงูุ ูููู ูุนุฒูู

### ุฑุคูุฉ ุงูุชูููู ููู

ุงูุชูููู ุงูุฌูุฏ ูุดูู:
- **ุงููุถูุญ**: ูู ุฌุฒุก ูุงุถุญ ุงููุฏู
- **ุงูุงูุณุฌุงู**: ุงูุฃุฌุฒุงุก ุชุชุนุงูู ุจุณูุงุณุฉ
- **ุงูุชูุงุฒู**: ูุง ุฌุฒุก ุถุฎู ุฌุฏุงู ุฃู ุตุบูุฑ ุฌุฏุงู
- **ุงูุฌูุงู**: ุงููุธุงู ูุจุฏู "ุตุญูุญุงู"

### ูุตุฉ: ูุนูุงุฑู ุงูุทุจูุนุฉ

ุงูุทุจูุนุฉ ุชูููู ุจุจุฑุงุนุฉ:
- **ุงูุฎูุงูุง**: ูุญุฏุงุช ุญูุงุฉ ูุณุชููุฉ
- **ุงูุฃุนุถุงุก**: ูุฌููุนุงุช ุฎูุงูุง ููููุฉ ูุงุญุฏุฉ
- **ุงูุฃูุธูุฉ**: ููุจุ ุฏูุงุบุ ูุถู...
- **ุงููุงุฆู**: ุชูุงูู ุงูุฃูุธูุฉ

ูู ูุณุชูู ูู ุงุณุชููุงููุชูุ ูููู ูุชุนุงูู ูุน ุงูุจุงูู.

ุงููุนูุงุฑู ูุชุนูู ูู ูุฐุง.

---

*ูุชุจุน ุงูุฌุฒุก ุงูุซุงูุซ...*


---

## 2.9 ููุงูุญุฉ ุงูุฃููุงุท ุงูุณูุฆุฉ (Anti-Patterns)

### Anti-Pattern 1: God Class (ุงููุฆุฉ ุงูุฅูููุฉ)

**ุงูุฃุนุฑุงุถ:**
- ูุฆุฉ ุชุญุชูู ุนูู 1000+ ุณุทุฑ
- ุชูุนู ูู ุดูุก
- ุชุนุชูุฏ ุนูููุง ูู ุงููุฆุงุช ุงูุฃุฎุฑู

**ุงููุซุงู:**
```php
// โ God Class
class OrderManager {
    public function createOrder($data) { /* 200 lines */ }
    public function updateOrder($id, $data) { /* 150 lines */ }
    public function deleteOrder($id) { /* 100 lines */ }
    public function processPayment($orderId) { /* 300 lines */ }
    public function sendNotification($orderId) { /* 150 lines */ }
    public function generateInvoice($orderId) { /* 200 lines */ }
    public function updateInventory($orderId) { /* 150 lines */ }
    public function calculateShipping($orderId) { /* 180 lines */ }
    // ... 20 methods more
}
```

**ุงูุญู:**
```php
// โ ุงูุชูููู ุงูุตุญูุญ
class OrderService {
    public function __construct(
        private OrderRepository $repository,
        private PaymentService $payment,
        private NotificationService $notification,
        private InvoiceGenerator $invoice,
        private InventoryManager $inventory,
        private ShippingCalculator $shipping
    ) {}
    
    public function createOrder(CreateOrderCommand $command): Order {
        $order = Order::create($command);
        $this->repository->save($order);
        return $order;
    }
}

class PaymentService {
    public function processPayment(Order $order): PaymentResult {
        // ููุทู ุงูุฏูุน ููุท
    }
}

class InvoiceGenerator {
    public function generate(Order $order): Invoice {
        // ููุทู ุงูููุงุชูุฑ ููุท
    }
}
```

### Anti-Pattern 2: Spaghetti Code (ููุฏ ุงูุณุจุงุบูุชู)

**ุงูุฃุนุฑุงุถ:**
- ุชุฏูู ุบูุฑ ูุงุถุญ
- GOTO-like logic (ูู PHP: returns ูู ููุชุตู ุงูุฏุงูุฉ)
- ุชุฏุงุฎู ุนููู (Deep nesting)

**ุงููุซุงู:**
```php
// โ Spaghetti
function processOrder($order) {
    if ($order) {
        if ($order->status == 'pending') {
            if ($order->items->count() > 0) {
                foreach ($order->items as $item) {
                    if ($item->in_stock) {
                        // ... 50 lines more
                        if ($payment_success) {
                            // ...
                            return 'success';
                        } else {
                            return 'payment_failed';
                        }
                    } else {
                        return 'out_of_stock';
                    }
                }
            } else {
                return 'empty_order';
            }
        } else {
            return 'invalid_status';
        }
    } else {
        return 'no_order';
    }
}
```

**ุงูุญู - Early Returns + Guard Clauses:**
```php
// โ ูุงุถุญ ููุจุงุดุฑ
function processOrder(?Order $order): ProcessResult {
    if (!$order) {
        return ProcessResult::noOrder();
    }
    
    if (!$order->isPending()) {
        return ProcessResult::invalidStatus($order->status);
    }
    
    if ($order->isEmpty()) {
        return ProcessResult::emptyOrder();
    }
    
    if (!$order->allItemsInStock()) {
        return ProcessResult::outOfStock($order->getOutOfStockItems());
    }
    
    $payment = $this->processPayment($order);
    if (!$payment->isSuccessful()) {
        return ProcessResult::paymentFailed($payment->getError());
    }
    
    return ProcessResult::success($order);
}
```

### Anti-Pattern 3: Golden Hammer (ุงููุทุฑูุฉ ุงูุฐูุจูุฉ)

**ุงูุฃุนุฑุงุถ:**
- "ุนูุฏู ูุทุฑูุฉุ ูู ุดูุก ูุจุฏู ูุณูุงุฑุงู"
- ุงุณุชุฎุฏุงู ููุท ูุงุญุฏ ููู ุดูุก
- "ูุญู ูุณุชุฎุฏู Microservices ูุฃู Google ุชุณุชุฎุฏููุง"

**ุงูุญู:**
ุงุฎุชุฑ ุงูุฃุฏุงุฉ ุงูููุงุณุจุฉ ูููุดููุฉ:

| ุงููุดููุฉ | ุงูุญู |
|---------|------|
| MVP ุณุฑูุน | Monolith |
| ูุทุงู ุถุฎู | Microservices |
| ุจูุงูุงุช ูุนูุฏุฉ | DDD |
| CRUD ุจุณูุท | Active Record |
| ููุทู ุนูู ูุนูุฏ | Domain Model |

### Anti-Pattern 4: Lava Flow (ุชุฏูู ุงูุญูู)

**ุงูุฃุนุฑุงุถ:**
- ููุฏ ูุฏูู "ููุช" ููู ูุง ุฃุญุฏ ูุฌุฑุค ุนูู ุญุฐูู
- "ูุชุฑูู ููุง ูุฃูู ูุฏ ูุญุชุงุฌู"
- ุชุนูููุงุช TODO ูู 3 ุณููุงุช

**ุงูุญู:**
1. ุงุณุชุฎุฏู ุฃุฏูุงุช ุชุญููู ุงูููุฏ ูุงูุชุดุงู ุงูููุฏ ุบูุฑ ุงููุณุชุฎุฏู
2. ุงุญุฐู ุจุญุฐุฑ ูุน ุงุฎุชุจุงุฑุงุช
3. ุงุณุชุฎุฏู Git ููุชุงุฑูุฎุ ูุง ููููุฏ ุงูููุช

```bash
# ุงุณุชุฎุฏู static analysis
phpstan analyse --level=8
psalm --find-unused-code
```

### Anti-Pattern 5: Copy-Paste Programming

**ุงูุฃุนุฑุงุถ:**
- ููุณ ุงูููุฏ ูู 10 ุฃูุงูู
- ุชุบููุฑ ูู ููุงู ูุชุทูุจ ุชุบููุฑ ูู 9 ุฃูุงูู ุฃุฎุฑู
- "ููู ูู ูุงุญุฏ ูุฎุชูู ููููุงู!"

**ุงูุญู - DRY (Don't Repeat Yourself):**
```php
// โ ุชูุฑุงุฑ
function createUser($data) {
    $user = new User();
    $user->name = $data['name'];
    $user->email = $data['email'];
    $user->created_at = now();
    $user->save();
    return $user;
}

function createAdmin($data) {
    $admin = new Admin();
    $admin->name = $data['name'];
    $admin->email = $data['email'];
    $admin->created_at = now();
    $admin->save();
    return $admin;
}

// โ ุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
abstract class UserCreator {
    abstract protected function createInstance(): User;
    
    public function create(array $data): User {
        $user = $this->createInstance();
        $user->fill($data);
        $user->created_at = now();
        $user->save();
        return $user;
    }
}

class RegularUserCreator extends UserCreator {
    protected function createInstance(): User {
        return new User();
    }
}

class AdminCreator extends UserCreator {
    protected function createInstance(): User {
        return new Admin();
    }
}
```

---

## 2.10 ุงุณุชุฑุงุชูุฌูุงุช ุงููุฌุฑุฉ ูู Monolith ุฅูู Microservices

### ุงูุงุณุชุฑุงุชูุฌูุฉ 1: Incremental Extraction (ุงูุงุณุชุฎุฑุงุฌ ุงูุชุฏุฑูุฌู)

**ูุชู ุชุณุชุฎุฏููุง:**
- ุงููุธุงู ูุนูู ููุง ูููู ุฅููุงูู
- ุงููุฑูู ูุญุฏูุฏ
- ุงููุฎุงุทุฑ ูุฌุจ ุฃู ุชููู ููุฎูุถุฉ

**ุงูุฎุทูุงุช:**

```
ุงููุฑุญูุฉ 1: ูุตู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ ุฅูุดุงุก views ูููุฑุงุกุฉ
โโโ ููู ุงููุชุงุจุฉ ูู APIs
โโโ ูุฏุฉ: 3-6 ุฃุดูุฑ

ุงููุฑุญูุฉ 2: ุงุณุชุฎุฑุงุฌ ุฃูู ุฎุฏูุฉ
โโโ ุงุฎุชูุงุฑ ุฎุฏูุฉ ูุงุถุญุฉ ุงูุญุฏูุฏ
โโโ ุจูุงุก Anti-Corruption Layer
โโโ ุชุดุบูู ููุงุฒู
โโโ ูุฏุฉ: 6-12 ุดูุฑ

ุงููุฑุญูุฉ 3: ุงูุชูุฑุงุฑ
โโโ ุงุณุชุฎุฑุงุฌ ุฎุฏูุฉ ุซุงููุฉ
โโโ ุงุณุชุฎุฑุงุฌ ุฎุฏูุฉ ุซุงูุซุฉ
โโโ ูุฏุฉ: 1-2 ุณูุฉ

ุงููุฑุญูุฉ 4: ุงูุชูุธูู
โโโ ุญุฐู ุงูููุฏ ุงููุฏูู
โโโ ุฅุนุงุฏุฉ ููููุฉ
โโโ ูุฏุฉ: ูุณุชูุฑ
```

### ุงูุงุณุชุฑุงุชูุฌูุฉ 2: Parallel Rewrite (ุฅุนุงุฏุฉ ุงููุชุงุจุฉ ุงููุชูุงุฒูุฉ)

**ูุชู ุชุณุชุฎุฏููุง:**
- ุงููุธุงู ุงููุฏูู ูุงุดู ุชูุงูุงู
- ุงูููุงุฑุฏ ูุชููุฑุฉ ููุฑูููู
- ูููู ุชุดุบูู ุงููุธุงููู ูุนุงู ููุชุฑุฉ

**ุงููููุฐุฌ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         API Gateway (Router)            โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
        โโโโโโโดโโโโโโโ
        โ            โ
โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ
โ   Legacy     โ โ    New       โ
โ   System     โ โ   System     โ
โ  (ุชุชููุต)     โ โ  (ุชููู)      โ
โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ
```

**ุงูุชุฏุฑูุฌ:**
- ุงูุดูุฑ 1-3: 10% ูููุธุงู ุงูุฌุฏูุฏ
- ุงูุดูุฑ 4-6: 30% ูููุธุงู ุงูุฌุฏูุฏ
- ุงูุดูุฑ 7-12: 70% ูููุธุงู ุงูุฌุฏูุฏ
- ุงูุดูุฑ 13+: 100% ูููุธุงู ุงูุฌุฏูุฏ

### ุงูุงุณุชุฑุงุชูุฌูุฉ 3: Strangler Fig (ุงูุฎูู)

**ูุชู ุชุณุชุฎุฏููุง:**
- ูุธุงู ุถุฎู ุฌุฏุงู
- ูุง ูููู ุฅุนุงุฏุฉ ูุชุงุจุชู ุฏูุนุฉ ูุงุญุฏุฉ
- ูุญุชุงุฌ ููุชุทููุฑ ุงููุณุชูุฑ ุฃุซูุงุก ุงููุฌุฑุฉ

**ุงูุชูููุฐ:**

```php
// API Gateway ูุฎูู ุงููุธุงู ุงููุฏูู ุชุฏุฑูุฌูุงู
class StranglerGateway {
    private array $extractedRoutes = [
        '/api/v2/payments' => PaymentService::class,
        '/api/v2/inventory' => InventoryService::class,
        // ูุชู ุฅุถุงูุฉ ุงููุฒูุฏ ูุน ุงูููุช
    ];
    
    public function handle(Request $request): Response {
        $path = $request->getPath();
        
        // ุฅุฐุง ูุงูุช ุงููุธููุฉ ูุณุชุฎุฑุฌุฉุ ุงุณุชุฎุฏู ุงูุฎุฏูุฉ ุงูุฌุฏูุฏุฉ
        foreach ($this->extractedRoutes as $route => $service) {
            if (str_starts_with($path, $route)) {
                return $this->forwardToNewService($service, $request);
            }
        }
        
        // ุบูุฑ ุฐููุ ุงุณุชุฎุฏู ุงููุธุงู ุงููุฏูู
        return $this->forwardToLegacy($request);
    }
}
```

### ููุงุฑูุฉ ุงูุงุณุชุฑุงุชูุฌูุงุช

| ุงูุงุณุชุฑุงุชูุฌูุฉ | ุงููุฎุงุทุฑ | ุงูููุช | ุงูุชูููุฉ | ูุชู ุชุณุชุฎุฏู |
|-------------|--------|-------|--------|-----------|
| Incremental | ููุฎูุถุฉ | ุทููู | ูุชูุณุทุฉ | ูุนุธู ุงูุญุงูุงุช |
| Parallel | ุนุงููุฉ | ูุตูุฑ | ุนุงููุฉ | ูุธุงู ูุงุดู |
| Strangler | ูุชูุณุทุฉ | ุทููู ุฌุฏุงู | ุนุงููุฉ | ูุธุงู ุถุฎู |

---

## 2.11 ุฃุฏูุงุช ุงูุชูููู ุงูุนูููุฉ

### ุงูุฃุฏุงุฉ 1: Event Storming

**ูุง ููุ**
ุฌูุณุฉ ุฌูุงุนูุฉ ูุงูุชุดุงู ุงููุธุงู ุนุจุฑ ุงูุฃุญุฏุงุซ.

**ุงููุดุงุฑููู:**
- ูุทูุฑูู
- ูุตููู UX
- ุฃุตุญุงุจ ุงูููุชุฌ
- ุฎุจุฑุงุก ุงููุฌุงู

**ุงูุฎุทูุงุช:**
1. **ุงูุฃุญุฏุงุซ ุงูุจุฑุชูุงููุฉ**: ูุง ูุญุฏุซ ูู ุงููุธุงูุ
2. **ุงูุฃูุงูุฑ ุงูุฃุฒุฑู**: ูุง ุงูุฐู ููุณุจุจ ุงูุญุฏุซุ
3. **ุงูููุงูุงุช ุงูุตูุฑุงุก**: ูุง ุงูุจูุงูุงุช ุงููุชุฃุซุฑุฉุ
4. **ุงูุณูุงุณุงุช ุงูุจููุณุฌูุฉ**: ูุง ุงูููุงุนุฏุ

**ูุซุงู:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [OrderCreated] โ [CreateOrder] โ User  โ
โ      โ                                  โ
โ [PaymentRequested]                      โ
โ      โ                                  โ
โ [PaymentConfirmed] โ [ConfirmPayment]   โ
โ      โ                                  โ
โ [OrderShipped]                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุงูุฃุฏุงุฉ 2: Domain Storytelling

**ูุง ููุ**
ุณุฑุฏ ุงููุตุต ุญูู ููู ูุนูู ุงููุธุงู.

**ุงูุตูุบุฉ:**
"[ูู] [ููุนู] [ูุง] ูุน [ุงูุจูุงูุงุช]"

**ูุซุงู:**
```
"ุนููู ูุทูุจ ููุชุฌ ุจุงุณุชุฎุฏุงู ุงูุณูุฉ"
"ููุธู ุงููุณุชูุฏุน ูุฌูุฒ ุงูุทูุจ ุจุงุณุชุฎุฏุงู ูุงุฆูุฉ ุงูุชุฌููุฒ"
"ุณุงุนู ุงูุจุฑูุฏ ููุตู ุงูุทูุจ ููุนููู"
```

**ุงูุฑุณู:**
```
[ุนููู] โโโถ [ุงูุณูุฉ] โโโถ [ุงูุทูุจ] โโโถ [ุงููุณุชูุฏุน] โโโถ [ุงูุชูุตูู]
```

### ุงูุฃุฏุงุฉ 3: Context Mapping

**ูุง ููุ**
ุฑุณู ุฎุฑูุทุฉ ููุณูุงูุงุช ูุนูุงูุงุชูุง.

**ุฃููุงุน ุงูุนูุงูุงุช:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                     โ
โ   [Sales Context]        [Inventory Context]        โ
โ         โ                        โ                  โ
โ         โ  Customer-Supplier     โ                  โ
โ         โโโโโโโโโโโโโโโโโโโโโโโโโบโ                  โ
โ         โ                        โ                  โ
โ         โ  Anti-Corruption       โ                  โ
โ         โ       Layer            โ                  โ
โ         โโโโโโโโโโโโโโโโโโโโโโโโโบโ                  โ
โ         โ                        โ                  โ
โ   [Payment Context]         [Legacy Context]        โ
โ         โ                                            โ
โ         โ Published Language                         โ
โ         โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโบ  โ
โ         โ                                            โ
โ   [Shipping Context]                                โ
โ                                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงูุฃููุงุท:**
- **Partnership**: ุชุนุงูู ูุซูู
- **Customer-Supplier**: ุฃุญุฏููุง ูุฎุฏู ุงูุขุฎุฑ
- **Conformist": ูุชุจุน ุงููููุฐุฌ ุงูุขุฎุฑ
- **Anti-Corruption Layer**: ุญูุงูุฉ ูู ุงูุชุฃุซูุฑุงุช
- **Open Host Service**: ุฎุฏูุฉ ููุชูุญุฉ ููุฌููุน
- **Published Language**: ูุบุฉ ูุดุชุฑูุฉ

### ุงูุฃุฏุงุฉ 4: Architecture Decision Records (ADRs)

**ุงููุงูุจ:**
```markdown
# ADR 042: ุงุณุชุฎุฏุงู Message Queue ูููุนุงูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ

## ุงูุญุงูุฉ (Context)
ูุธุงู ุงูุทูุจุงุช ูุนุงูู ูู ุจุทุก ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุฏูุน ูุงููุฎุฒูู.
ุงููุณุชุฎุฏู ููุชุธุฑ 5-10 ุซูุงูู ููู ุทูุจ.

## ุงููุฑุงุฑ (Decision)
ุณูุณุชุฎุฏู RabbitMQ ููุนุงูุฌุฉ ุงูุนูููุงุช ุงูุซูููุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู.

## ุงูุจุฏุงุฆู ุงููุฑููุถุฉ
- **AWS SQS**: ููุณ ูุฏููุง ุฎุจุฑุฉ ูู AWS
- **Redis Queue**: ูุง ูููุฑ ุถูุงูุงุช ุงูุชุณููู
- **Kafka**: ูุนูุฏ ุฌุฏุงู ูุงุญุชูุงุฌุงุชูุง ุงูุญุงููุฉ

## ุงูุนูุงูุจ ุงูุฅูุฌุงุจูุฉ
- + ุณุฑุนุฉ ุงุณุชุฌุงุจุฉ ุฃุนูู ูููุณุชุฎุฏู
- + ูุงุจููุฉ ุชูุณุน ุฃูุถู
- + ูุนุงูุฌุฉ ุฃุฎุทุงุก ุฃูุถู

## ุงูุนูุงูุจ ุงูุณูุจูุฉ
- - ุชุนููุฏ ุจููุฉ ุฅุถุงูู
- - ุชุฃุฎูุฑ ูู ุฑุคูุฉ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
- - ุญุงุฌุฉ ููุฑุงูุจุฉ ุฅุถุงููุฉ

## ุงูููุงุญุธุงุช
ุชู ุงุชุฎุงุฐ ุงููุฑุงุฑ ุจุชุงุฑูุฎ 2024-01-15 ูู ูุจู ุงููุฑูู ุงููุนูุงุฑู.
```

---

## 2.12 ููุงุจูุฉ ูุน ูุนูุงุฑู: ุฃุณุฑุงุฑ ุงูุชูููู

### ุงููุญุงูุฑุฉ

**ุงูุณุคุงู:** ูุง ูู ุฃูุจุฑ ุฎุทุฃ ูุฑุชูุจู ุงููุทูุฑูู ูู ุงูุชููููุ

**ุงููุนูุงุฑู:** ุงูุชูููู ุงูุฒุงุฆุฏ. ูุจุฏุฃ ุงููุงุณ ุจุชูุณูู ูู ุดูุก ูู "ุฎุฏูุงุช ูุตุบุฑุฉ" ุญุชู ูุตููู ูู "ูุงููุณูุฑููุณ" - ุฎุฏูุงุช ูุง ุชูุนู ุดูุฆุงู. ููุจุฏุฃูู ุจุฏูุฌูุง ูุฑุฉ ุฃุฎุฑู.

**ุงูุณุคุงู:** ููู ุชุนุฑู ุฃูู ูุณูุช ุจุงูุดูู ุงูุตุญูุญุ

**ุงููุนูุงุฑู:** ูุงุนุฏุฉ ุจุณูุทุฉ: ุฅุฐุง ูู ุชุณุชุทุน ุดุฑุญ ูุง ุชูุนูู ุงูุฎุฏูุฉ ูู ุฌููุฉ ูุงุญุฏุฉุ ููู ูุจูุฑุฉ ุฌุฏุงู. ูุฅุฐุง ุงุญุชุฌุช ูู 10 ุฎุฏูุงุช ูุชูููุฐ ุนูููุฉ ูุงุญุฏุฉุ ููู ุตุบูุฑุฉ ุฌุฏุงู.

**ุงูุณุคุงู:** ูุง ูุตูุญุชู ูููุฑู ุงูุชู ุชุจุฏุฃ ุฑุญูุฉ ุงูุชููููุ

**ุงููุนูุงุฑู:** ุซูุงุซุฉ ุฃุดูุงุก:
1. **ุงุจุฏุฃ ุจุงูุจูุงูุงุช**: ุฅุฐุง ูู ุชูุตู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูู ุชูุตู ุดูุฆุงู
2. **ูุง ุชุณุชุฎุฏู ุงูุชูููุฉ ูุญู**: Microservices ููุณุช ุญูุงู ููู ุดูุก
3. **ูู ุตุจูุฑุงู**: ุงููุฌุฑุฉ ุชุฃุฎุฐ ุณููุงุชุ ููุณ ุฃุดูุฑุงู

**ุงูุณุคุงู:** ููู ุชููุณ ูุฌุงุญ ุงูุชููููุ

**ุงููุนูุงุฑู:** ููุณ ุจุนุฏุฏ ุงูุฎุฏูุงุช! ุจู ุจู:
- ุณุฑุนุฉ ุงูุชุบููุฑ
- ูุนุฏู ุงูุฃุฎุทุงุก
- ุณุนุงุฏุฉ ุงููุฑูู

**ุงูุณุคุงู:** ูุง ุฃูุจุฑ ุฏุฑุณ ุชุนููุชูุ

**ุงููุนูุงุฑู:** ุฃู ุงูุชูููู ุงูุฌูุฏ ูุญุชุงุฌ ูููู ุนููู ูููุฌุงู. ูุง ููููู ุชูุณูู ูุธุงู ูุง ุชูููู. ุงูุถู ููุชุงู ูุน ุฎุจุฑุงุก ุงููุฌุงู ูุจู ุฃู ุชููุณ ุงูููุฏ.

---

## 2.13 ุชูุงุฑูู ุนูููุฉ

### ุงูุชูุฑูู 1: ุชูููู ูุธุงู ุงูููุชุจุฉ

**ุงูุณููุงุฑูู:**
ูุธุงู ุฅุฏุงุฑุฉ ููุชุจุฉ ูุญุชูู ุนูู:
- ุฅุฏุงุฑุฉ ุงููุชุจ
- ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก
- ุงูุฅุนุงุฑุฉ ูุงูุฅุฑุฌุงุน
- ุงูุบุฑุงูุงุช
- ุงูุชูุงุฑูุฑ

**ุงููุทููุจ:**
1. ุญุฏุฏ Bounded Contexts
2. ุงุฑุณู Context Map
3. ุญุฏุฏ ุงูุนูุงูุงุช ุจูููุง
4. ุงูุชุฑุญ ุฎุฏูุงุช (ุฅุฐุง ููุช ุชุณุชุฎุฏู Microservices)

### ุงูุชูุฑูู 2: ุชุญููู ูุธุงู ููุฌูุฏ

**ุงูุณููุงุฑูู:**
ูุฏูู ูุธุงู Laravel ุจู:
- 50 Controller
- 30 Model
- 20 Service Class

**ุงููุทููุจ:**
1. ุงูุชุดู God Classes
2. ุงูุชุดู Spaghetti Code
3. ุงูุชุฑุญ ุฎุทุฉ ุฅุนุงุฏุฉ ููููุฉ

### ุงูุชูุฑูู 3: ุชุตููู Anti-Corruption Layer

**ุงูุณููุงุฑูู:**
ูุธุงู ุฌุฏูุฏ ูุญุชุงุฌ ููุชูุงุตู ูุน API ูุฏูู ูุฑุฌุน:
```json
{
    "cust_id": 12345,
    "cust_nm": "John Doe",
    "cust_addr": "123 Main St",
    "cust_stat": "A",
    "cust_bal": "1000.50"
}
```

**ุงููุทููุจ:**
ุงูุชุจ ACL ูุชุฑุฌู ูุฐุง ูู:
```php
class Customer {
    public function __construct(
        public readonly CustomerId $id,
        public readonly Name $name,
        public readonly Address $address,
        public readonly CustomerStatus $status,
        public readonly Money $balance
    ) {}
}
```

### ุงูุชูุฑูู 4: ุฑุณู C4 Diagram

**ุงูุณููุงุฑูู:**
ูุธุงู ุทูุจุงุช ุจุณูุท

**ุงููุทููุจ:**
ุงุฑุณู:
1. System Context Diagram
2. Container Diagram
3. Component Diagram

---

## ุฎุงุชูุฉ ุงููุตู ุงูุซุงูู: ูู ุงูุฑุคูุฉ

### ูุง ุชุนูููุงู

ูู ูุฐุง ุงููุตู ุงูุดุงููุ ุบุทููุง:

1. **ุฃุณุณ ุงูุชูููู**: ุงูุชุฑุงุจุท ุงููุธูููุ ุนุฒู ุงููุนูููุงุชุ ุงูุงุณุชุจุฏุงู
2. **ุงูุงุณุชุฑุงุชูุฌูุงุช**: ุงููุธูููุ ุงููุฌุงููุ ุงูุทุจููุ ุงููุญูุฑู
3. **ุงูููุงุฐุฌ**: MVC, MVVM, Hexagonal, Clean Architecture
4. **ุงูุฃููุงุท ุงููุชูุฏูุฉ**: Strangler Fig, ACL, Saga, CQRS
5. **ุงูุฏุฑุงุณุฉ ุงูุนูููุฉ**: ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงู ูู ุงูุตูุฑ
6. **ุงุฎุชุจุงุฑ ุงูุฃูุธูุฉ ุงููููููุฉ**: CDC, Contract Testing, E2E
7. **ููุงูุญุฉ Anti-Patterns**: God Class, Spaghetti, Golden Hammer
8. **ุงุณุชุฑุงุชูุฌูุงุช ุงููุฌุฑุฉ**: Incremental, Parallel, Strangler
9. **ุงูุฃุฏูุงุช**: Event Storming, Domain Storytelling, Context Mapping
10. **ุงูููุณูุฉ**: ุงูุชุนููุฏ ุงูุถุฑูุฑู vs ุงูุนุฑุถู

### ุงูุฑุณุงูุฉ ุงูุฌููุฑูุฉ

> "ุงูุชูููู ููุณ ุชูุทูุนุงู ุนุดูุงุฆูุงูุ ุจู ุฑุคูุฉ ุนูููุฉ ููุนูุงูุงุช ูุงูุญุฏูุฏ."

ุงููุนูุงุฑู ุงูุฌูุฏ ูุฑู ููุณ "ูุง ูููู ุชูุณููู"ุ ุจู "ูุง ูุฌุจ ุฃู ูุจูู ูุนุงู".

### ุฅูู ุงููุตู ุงูุซุงูุซ

ูู **"ุณูููููุฌูุฉ ุงููุนูุงุฑู"**ุ ุณูุบูุต ูู ุงูุนูููุฉ ุงููุทููุจุฉ:
- ููู ุชููุฑุ
- ููู ุชุชุนููุ
- ููู ุชุชุฎุฐ ูุฑุงุฑุงุช ุชุญุช ุงูุถุบุทุ
- ููู ุชููุฏ ุงููุฑูุ

---

## ููุญู ุงููุตู ุงูุซุงูู: ูุงุฆูุฉ ุงูุชุญูู

### ูุจู ุงูุชูููู
- [ ] ูููุช ุงููุฌุงู ุจุนููุ
- [ ] ุญุฏุฏุช Bounded Contextsุ
- [ ] ุฑุณูุช Context Mapุ
- [ ] ุญุฏุฏุช ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูููุงุณุจุฉุ
- [ ] ุฌูุฒุช ุฎุทุฉ ุชุฑุงุฌุนุ

### ุฃุซูุงุก ุงูุชูููู
- [ ] ุงุฎุชุจุฑุช ูู ุฌุฒุก ูููุฑุฏุงูุ
- [ ] ุชุญููุช ูู ุงูุนููุฏ ุจูู ุงูุฃุฌุฒุงุกุ
- [ ] ูุซูุช ุงููุฑุงุฑุงุช (ADRs)ุ
- [ ] ุฑุงูุจุช ุงูุฃุฏุงุกุ
- [ ] ุนููุช ุงููุฑููุ

### ุจุนุฏ ุงูุชูููู
- [ ] ูุธูุช ุงูููุฏ ุงููุฏููุ
- [ ] ุญุฏุซุช ุงูุชูุซููุ
- [ ] ุฑุงุฌุนุช ุงูุฃุฏุงุกุ
- [ ] ุณุฃูุช ุงููุฑูู ุนู ุฑุฃูููุ

---

**ยฉ 2025 ูุญูุฏ ุงูุนุจูุฏ | ุงููุนูุงุฑู**

*"ุงูุณูุงุฏุฉ ุงูุญููููุฉ ุนูู ุญุฑูุชู"*

**ููุงูุฉ ุงููุตู ุงูุซุงูู - ุฃูุทูููุฌูุง ุงูุชูููู**


---

## 2.14 ุงูุชูููู ูู ุนุงูู ุงููุงูุน: ุฏุฑุงุณุงุช ุญุงูุฉ ูุชุนุฏุฏุฉ

### ุฏุฑุงุณุฉ ุญุงูุฉ 1: Uber - ูู Monolith ูู Microservices

#### ุงูุฎูููุฉ (2014)
- ูุธุงู Ruby on Rails ูุงุญุฏ
- 300+ ูุทูุฑ
- ูุดุฑ ูููู ุตุนุจ
- "Deploy day" ูุงู ููู ุฑุนุจ

#### ุงูุชุญูู
**2015**: ุจุฏุฃูุง ุจุชูุณูู ุงูุฎุฏูุงุช ุญุณุจ ุงููุธุงุฆู:
- ride-service (ุงูุฑุญูุงุช)
- driver-service (ุงูุณุงุฆููู)
- passenger-service (ุงูุฑูุงุจ)
- payment-service (ุงููุฏููุนุงุช)

**2016-2017**: ุฒุงุฏูุง ูู 1000+ ุฎุฏูุฉ

**ุงููุดููุฉ**: "Death Star Architecture"
```
        โโโโโโโโโโโโ
        โ  ride    โ
        โโโโโโฌโโโโโโ
             โ
    โโโโโโโโโโผโโโโโโโโโ
    โ        โ        โ
โโโโโโโโโ โโโโโโโโโ โโโโโโโโโ
โdriver โ โpaymentโ โnotify โ
โโโโโฌโโโโ โโโโโฌโโโโ โโโโโฌโโโโ
    โ         โ         โ
    โโโโโโโโโโโผโโโโโโโโโโ
              โ
        โโโโโโโโโโโโ
        โ database โ
        โโโโโโโโโโโโ
```

ูู ุฎุฏูุฉ ุชุชููู ูุน ูู ุงูุฎุฏูุงุช!

#### ุงูุญู
**2018+**: Domain-Oriented Microservices
- ุฑููุฒูุง ุนูู Bounded Contexts
- ููููุง ุงูุงุฑุชุจุงุทุงุช
- ุจููุง "Service Mesh" ููุชูุงุตู

#### ุงูุฏุฑูุณ
1. **ูุง ุชูุฑุท**: 1000 ุฎุฏูุฉ ูุซูุฑุฉ ุฌุฏุงู
2. **ุงูุจูุงูุงุช ุฃููุงู**: ูุตู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃูู
3. **ุงููุฑุงูุจุฉ ุถุฑูุฑูุฉ**: ุจุฏูููุงุ ููุถู

---

### ุฏุฑุงุณุฉ ุญุงูุฉ 2: Shopify - ุงูุญูุงุธ ุนูู Monolith

#### ุงูููุงุฌุฃุฉ
Shopify ูู ูุชุญูู ูู Microservices!

#### ููุงุฐุงุ
- Monolithูู "Modular"
- ุญุฏูุฏ ูุงุถุญุฉ ุฏุงุฎู ุงูููุฏ
- "Packwerk" (ุฃุฏุงุฉ Ruby) ุชุญูู ุงูุญุฏูุฏ

#### ุงููููุฐุฌ: Modular Monolith
```
shopify/
โโโ components/
โ   โโโ checkout/
โ   โ   โโโ app/
โ   โ   โโโ test/
โ   โ   โโโ checkout.gemspec
โ   โโโ payments/
โ   โโโ shipping/
โ   โโโ inventory/
โโโ platform/ (ุงูููุงุฉ ุงููุดุชุฑูุฉ)
โโโ Gemfile
```

ูู component:
- ูู ุญุฏูุฏ ูุงุถุญุฉ
- ูุง ููููู ุงูุงุนุชูุงุฏ ุนูู ุงูุขุฎุฑูู ูุจุงุดุฑุฉ
- ููุฎุชุจุฑ ูููุฑุฏุงู

#### ูุชู ูุนูู Modular Monolithุ
- ูุฑูู ูุงุญุฏ ูุจูุฑ (100-300)
- ุจููุฉ ูุงุถุญุฉ
- ุฃุฏูุงุช ูุญูุงูุฉ ุงูุญุฏูุฏ

#### ุงูุฏุฑูุณ
**ููุณุช Microservices ุฃู ูุง ุดูุก!**

| Monolith | Modular Monolith | Microservices |
|----------|-----------------|---------------|
| ูุฑูู ุตุบูุฑ | ูุฑูู ูุจูุฑ | ุนุฏุฉ ูุฑู |
| ุจุณูุท | ูุนูุฏ | ูุนูุฏ ุฌุฏุงู |
| ุชุทููุฑ ุณุฑูุน | ุชุทููุฑ ุณุฑูุน | ุชุทููุฑ ุฃุจุทุฃ |
| ุตุนุจ ุงูุชูุณุน | ูุงุจู ููุชูุณุน | ูุงุจู ููุชูุณุน |

---

### ุฏุฑุงุณุฉ ุญุงูุฉ 3: Etsy - ุงูุจูุงูุงุช ุฃููุงู

#### ุงูุฎูููุฉ
- Monolith PHP ุถุฎู
- ูุงุนุฏุฉ ุจูุงูุงุช MySQL ูุงุญุฏุฉ
- ุฃุฏุงุก ูุชุฏููุฑ

#### ุงูุงุณุชุฑุงุชูุฌูุฉ
**ูู ูุจุฏุฃูุง ุจู Microservices!**

**ุงูุฎุทูุฉ 1**: ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุดุงุฑููุง ุงููุฑุงุกุฉ (read replicas)
- ูุตููุง ุงููุชุงุจุฉ (write sharding)

**ุงูุฎุทูุฉ 2**: Caching
- Memcached ููู ุดูุก
- Reduced DB load by 80%

**ุงูุฎุทูุฉ 3**: APIs ุฏุงุฎููุฉ
- ุบูููุง Monolith ุจู APIs
- "API-First" approach

**ุงูุฎุทูุฉ 4**: ุงุณุชุฎุฑุงุฌ ุฎุฏูุงุช
- ููุท ุนูุฏูุง APIs ูู ุชููู

#### ุงููุชูุฌุฉ
- Monolith ูุง ูุฒุงู ููุฌูุฏ (2024)
- ูููู "API-fied"
- ุฎุฏูุงุช ููููุฉ ุฌุฏุงู ูููุธุงุฆู ุงูุฎุงุตุฉ

#### ุงูุฏุฑูุณ
**"Don't microservice prematurely"**

---

## 2.15 ุงูุชูููู ูุงูุฃูุงู

### Security by Design

ุงูุชูููู ุงูุฌูุฏ ูุญูู ุชููุงุฆูุงู:

**1. Defense in Depth**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        Firewall             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ      API Gateway            โ
โ   (Rate Limiting, Auth)     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ     Service Mesh            โ
โ   (mTLS, Policies)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ    Application              โ
โ   (Validation)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ     Database                โ
โ   (Encryption, ACLs)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**2. Least Privilege**
ูู ุฎุฏูุฉ ููุง ุตูุงุญูุงุชูุง ููุท:
```yaml
# payment-service
permissions:
  - read: payments
  - write: payments
  - read: customers # ููุชุญูู ููุท
  
# ูุง ููููู:
# - delete: payments
# - write: inventory
```

**3. Blast Radius Reduction**
ุงุฎุชุฑุงู ุฎุฏูุฉ ูุงุญุฏุฉ ูุง ูุนูู ุงุฎุชุฑุงู ุงููู:
```
Before:                  After:
โโโโโโโโโโโ             โโโโโโโ โโโโโโโ โโโโโโโ
โ Monolithโ โ hacked    โ svc1โ โ svc2โ โ svc3โ
โ (all)   โ = all lost  โhack โ โsafe โ โsafe โ
โโโโโโโโโโโ             โโโโโโโ โโโโโโโ โโโโโโโ
```

### Zero Trust Architecture

"ูุง ุชุซู ุจุฃุญุฏุ ุญุชู ุฏุงุฎููุงู"

**ุงููุจุงุฏุฆ:**
1. **Verify explicitly**: ุชุญูู ูู ูู ุทูุจ
2. **Use least privilege**: ุฃูู ุตูุงุญูุงุช ููููุฉ
3. **Assume breach**: ุงูุชุฑุถ ุงูุงุฎุชุฑุงู ูุฎูู ุงูุฃุซุฑ

**ุงูุชูููุฐ:**
```php
// ูู ุฎุฏูุฉ ุชุชุญูู ูู ุงููููุฉ
class OrderService {
    public function createOrder(Request $request): Order {
        // ุงูุชุญูู ูู JWT
        $identity = $this->auth->verify($request->token);
        
        // ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
        if (!$identity->can('create', 'order')) {
            throw new UnauthorizedException();
        }
        
        // ุงูุชุญูู ูู ูุณุจุฉ ุงูุทูุจุงุช
        if ($this->rateLimiter->isExceeded($identity->id)) {
            throw new RateLimitException();
        }
        
        return $this->create($request->data);
    }
}
```

---

## 2.16 ุงูุชูููู ูุงูุฃุฏุงุก

### ุงูููุงุถูุงุช (Trade-offs)

**Microservices ูุงูุฃุฏุงุก:**

| ุงูุฌุงูุจ | ุงูุชุฃุซูุฑ | ุงูุญู |
|--------|---------|------|
| ุงูุดุจูุฉ | ุชุฃุฎูุฑ ุจูู ุงูุฎุฏูุงุช | Caching, Async |
| ุงูุจูุงูุงุช | JOINs ุตุนุจุฉ | Data denormalization |
| ุงูุชุชุจุน | ุตุนูุจุฉ ููู ุงูุชุฏูู | Distributed tracing |
| ุงูุชุญุฌูู | ูุนูุฏ | Auto-scaling |

### ุงุณุชุฑุงุชูุฌูุงุช ุงูุฃุฏุงุก

**1. Caching ูุชุนุฏุฏ ุงููุณุชููุงุช**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Client Cache                โ
โ    (Browser, Mobile App)            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         CDN Cache                   โ
โ    (Static Assets)                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         API Gateway Cache           โ
โ    (Common Responses)               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Service Cache               โ
โ    (Redis, Memcached)               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Database Cache              โ
โ    (Query Cache, Buffer Pool)       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**2. Async Processing**
```php
// ูุจู: ูุชุฒุงููุ ุจุทูุก
$order = $this->createOrder($data);
$this->processPayment($order);
$this->sendNotifications($order);
$this->updateInventory($order);
// ุงูููุช: 5+ seconds

// ุจุนุฏ: ุบูุฑ ูุชุฒุงููุ ุณุฑูุน
$order = $this->createOrder($data);
$this->eventBus->publish(new OrderCreated($order));
return $order;
// ุงูููุช: 200ms

// ุงููุนุงูุฌุงุช ุชุณุชูุน ููุฃุญุฏุงุซ
class PaymentProcessor {
    public function onOrderCreated(OrderCreated $event): void {
        $this->processPayment($event->order);
    }
}

class NotificationProcessor {
    public function onOrderCreated(OrderCreated $event): void {
        $this->sendNotifications($event->order);
    }
}
```

**3. Database per Service**
```
โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ
โ   Orders     โ    โ   Payments   โ    โ  Inventory   โ
โ   Service    โ    โ   Service    โ    โ   Service    โ
โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ
       โ                   โ                   โ
       โ                   โ                   โ
โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ
โ   Orders     โ    โ   Payments   โ    โ  Inventory   โ
โ     DB       โ    โ     DB       โ    โ     DB       โ
โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ
```

**ุงููุงุฆุฏุฉ:**
- ูู ุฎุฏูุฉ ุชุชุญูู ูู ุจูุงูุงุชูุง
- ูููู ุชุญุณูู Schema ูุญุงูุฉ ุงูุงุณุชุฎุฏุงู
- Scale ูุณุชูู

**ุงูุชุญุฏู:**
- ุจูุงูุงุช ูุชูุฑุฑุฉ (denormalization)
- Eventual consistency
- ุตุนูุจุฉ ุงูุชูุงุฑูุฑ

---

## 2.17 ุงูุชูููู ูุงููุฑู

### Conway's Law (ูุฑุงุฌุนุฉ)

> "Organizations which design systems are constrained to produce designs which are copies of the communication structures of these organizations."

**ุงูุชุทุจูู:**
ุฅุฐุง ุฃุฑุฏุช Microservicesุ ูุธู ุงููุฑูู ุฃููุงู:

```
ูุฑู ูุชูุงููุฉ (Monolith)     ูุฑู ูุณุชููุฉ (Microservices)
โโโโโโโโโโโโโโโโโโโ         โโโโโโโ โโโโโโโ โโโโโโโ
โ  ูุฑูู ูุงุญุฏ      โ         โูุฑูู1โ โูุฑูู2โ โูุฑูู3โ
โ  (30 ุดุฎุต)       โ         โ(8)  โ โ(8)  โ โ(8)  โ
โโโโโโโโโโฌโโโโโโโโโ         โโโโฌโโโ โโโโฌโโโ โโโโฌโโโ
         โ                     โ       โ       โ
         โ                     โ       โ       โ
โโโโโโโโโโโโโโโโโโโ         โโโโโโโ โโโโโโโ โโโโโโโ
โ    Monolith     โ         โsvc1 โ โsvc2 โ โsvc3 โ
โโโโโโโโโโโโโโโโโโโ         โโโโโโโ โโโโโโโ โโโโโโโ
```

### Team Topologies

**ุงูุฃููุงุน:**

**1. Stream-Aligned Team**
- ูุฑูู ููุชุฌ ูุงูู
- ููุชูู ุฎุฏูุฉ ูู ุงูุจุฏุงูุฉ ููููุงูุฉ
- "You build it, you run it"

**2. Platform Team**
- ูุจูู ุจููุฉ ุชุญุชูุฉ ูุดุชุฑูุฉ
- CI/CD, Monitoring, Service Mesh

**3. Complicated Subsystem Team**
- ุฎุจุฑุงุก ูู ูุฌุงู ูุนูุฏ
- AI, Security, Performance

**4. Enabling Team**
- ูุณุงุนุฏ ุงููุฑู ุนูู ุงูุชุนูู
- ูุฏุฑุจุ ูุณุชุดูุฑุ ุซู ูุบุงุฏุฑ

**ุงูุนูุงูุงุช:**
- **Collaboration**: ุชุนุงูู ูุซูู ููุชุฑุฉ
- **X-as-a-Service**: ุฎุฏูุฉ ูุงุถุญุฉ
- **Facilitating**: ูุณุงุนุฏุฉ ูุชุฏุฑูุจ

---

## 2.18 ูุณุชูุจู ุงูุชูููู: ุงูุงุชุฌุงูุงุช ุงููุงุดุฆุฉ

### ุงูุงุชุฌุงู 1: Serverless

**ุงูููููู:**
ูุง serversุ ููุท functions:
```yaml
# AWS Lambda, Azure Functions, Google Cloud Functions
functions:
  createOrder:
    handler: handlers/order.create
    events:
      - http:
          path: /orders
          method: post
  
  processPayment:
    handler: handlers/payment.process
    events:
      - sqs: payment-queue
```

**ุงููุงุฆุฏุฉ:**
- Scaling ุชููุงุฆู
- Pay-per-use
- ุฃูู DevOps

**ุงูุชุญุฏู:**
- Cold starts
- Vendor lock-in
- ุตุนูุจุฉ Testing

### ุงูุงุชุฌุงู 2: WebAssembly (Wasm)

**ุงูููููู:**
ููุฏ ูุนูู ูู ุฃู ููุงู ุจุณุฑุนุฉ ุฃุตููุฉ:
```rust
// ุจูุบุฉ Rustุ ูุนูู ูู Browser ุฃู Server
#[no_mangle]
pub extern "C" fn calculate_total(items: &[Item]) -> f64 {
    items.iter().map(|i| i.price * i.quantity).sum()
}
```

**ุงูุงุณุชุฎุฏุงูุงุช:**
- Microservices ุณุฑูุนุฉ
- Plugin systems
- Edge computing

### ุงูุงุชุฌุงู 3: Event-Driven Everything

**ุงููุณุชูุจู:**
ูู ุดูุก ูุชูุงุนู ุนุจุฑ ุงูุฃุญุฏุงุซ:
```
โโโโโโโโโโโโโโโ    Event    โโโโโโโโโโโโโโโ
โ   Frontend  โ โโโโโโโโโโโ โ   Backend   โ
โโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโ
                                   โ
                                   โ Event
                                   โ
                            โโโโโโโโโโโโโโโ
                            โ   Database  โ
                            โ  (Event     โ
                            โ   Sourcing) โ
                            โโโโโโโโโโโโโโโ
```

**ุงููุงุฆุฏุฉ:**
- ุชุงุฑูุฎ ูุงูู
- Replay events
- Analysis real-time

---

## 2.19 ุฑุณุงูุฉ ุฎุชุงููุฉ: ุญููุฉ ุงูุชูููู

### ุงูููุงุนุฏ ุงูุฐูุจูุฉ

**1. ุงูุชูููู ููุณ ูุฏูุงู**
ูุง ุชูููู ูุฃู "Microservices ุฑุงุฆุฌุฉ".
ุฃููู ูุญู ูุดููุฉ: ุณุฑุนุฉุ ูููุงุณุ ูุฑูู.

**2. ุงูุจูุงูุงุช ุฃูู ูู ุงูููุฏ**
ูุตู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃุตุนุจ ูู ูุตู ุงูููุฏ.
ุงุจุฏุฃ ุจุงูุจูุงูุงุช.

**3. ุงูุจุณุงุทุฉ ุชููุฒ**
"Simplicity is the ultimate sophistication." - Leonardo da Vinci

**4. ุงูุชูููู ุฑุญูุฉ**
ูุง ูุญุฏุซ ุจูู ุนุดูุฉ ูุถุญุงูุง.
3-5 ุณููุงุช ูููุธุงู ุงููุจูุฑ.

**5. ุงูุซูุงูุฉ ุฃุณุงุณูุฉ**
ุงูุชูููู ุงูุฌูุฏ ูุญุชุงุฌ:
- ูููุงู ูุดุชุฑูุงู
- ุชูุงุตู ูุณุชูุฑุงู
- ุซูุฉ ุจูู ุงููุฑู

### ุงูุฏุงุฆุฑุฉ ุงูุฐูุจูุฉ ููุชูููู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              WHY?                   โ
โ     ููุงุฐุง ูููููุ ูุง ุงููุดููุฉุ       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ              HOW?                   โ
โ     ููู ูููููุ ูุง ุงูุงุณุชุฑุงุชูุฌูุฉุ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ              WHAT?                  โ
โ     ูุงุฐุง ูููููุ ูุง ุงูุฎุฏูุงุชุ        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ุงุจุฏุฃ ุจุงูู WHYุ ูุง ุจุงูู WHAT.

### ุงูุฎุงุชูุฉ ุงูุญููููุฉ

> "ุงูุชูููู ุงูุฌูุฏ ูุฌุนู ุงููุณุชุญูู ููููุงูุ ูุงููุนูุฏ ุจุณูุทุงูุ ูุงููุจูุฑ ูุงุจูุงู ููุฅุฏุงุฑุฉ."

ุงููุนูุงุฑู ููุณ ูู ููููู ุฃูุซุฑุ ุจู ูู ููููู ุจุฃูุซุฑ ุญููุฉ.

---

## ููุญู ุดุงูู: ูุงุฆูุฉ ุงููุตุงุฏุฑ ูุงูุฃุฏูุงุช

### ูุชุจ
1. **"Building Microservices"** - Sam Newman
2. **"The Art of Scalability"** - Martin Abbott
3. **"Domain-Driven Design"** - Eric Evans
4. **"Implementing Domain-Driven Design"** - Vaughn Vernon
5. **"Team Topologies"** - Matthew Skelton

### ุฃุฏูุงุช
- **EventStorming**: board (Miro, Mural) + sticky notes
- **C4 Model**: Structurizr, PlantUML
- **API Design**: OpenAPI, Postman
- **Service Mesh**: Istio, Linkerd
- **Monitoring**: Prometheus, Grafana, Jaeger

### ุฏูุฑุงุช
- **"Microservices with Node.js"** - Stephen Grider (Udemy)
- **"DDD Europe"** - Conference
- **"QCon"** - Conference

---

**ยฉ 2025 ูุญูุฏ ุงูุนุจูุฏ | ุงููุนูุงุฑู**

*"ุงูุณูุงุฏุฉ ุงูุญููููุฉ ุนูู ุญุฑูุชู"*

**ููุงูุฉ ุงููุตู ุงูุซุงูู - ุฃูุทูููุฌูุง ุงูุชูููู**
**ุงูุฅุตุฏุงุฑ ุงููุงูู - 40+ ุตูุญุฉ**


---

## 2.20 ุงูุชูููู ูุงูุฌูุฏุฉ: ุถูุงู ุงููุนุงููุฑ

### ุงูุฌูุฏุฉ ูู ุงูุฃูุธูุฉ ุงููููููุฉ

**ุงูุชุญุฏู:**
ุนูุฏูุง ูููู ูุฏูู 20 ุฎุฏูุฉุ ููู ุชุถูู ุฌูุฏุฉ ุงูููุ

**ุงูุงุณุชุฑุงุชูุฌูุงุช:**

#### 1. Standardization (ุงูุชูููุณ)

```yaml
# standards.yaml
service_standards:
  testing:
    coverage_minimum: 80%
    mutation_testing: required
    contract_tests: required
  
  documentation:
    api_spec: openapi_3_0
    adrs: required_for_major_decisions
    runbooks: required
  
  monitoring:
    health_checks: /health
    metrics: prometheus
    tracing: opentelemetry
  
  security:
    dependency_scanning: weekly
    sast: required
    secrets_management: vault
```

#### 2. Golden Path (ุงููุณุงุฑ ุงูุฐูุจู)

ูุงูุจ ููุญุฏ ููู ุฎุฏูุฉ ุฌุฏูุฏุฉ:
```
service-template/
โโโ src/
โ   โโโ Domain/
โ   โโโ Application/
โ   โโโ Infrastructure/
โโโ tests/
โ   โโโ Unit/
โ   โโโ Integration/
โ   โโโ Contract/
โโโ Dockerfile
โโโ docker-compose.yml
โโโ .github/
โ   โโโ workflows/
โ       โโโ ci.yml
โ       โโโ security.yml
โโโ Makefile
โโโ README.md
```

#### 3. Automated Governance

```yaml
# .github/workflows/governance.yml
name: Service Governance

on: [push, pull_request]

jobs:
  standards-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check Test Coverage
        run: |
          coverage=$(vendor/bin/phpunit --coverage-text | grep 'Lines' | awk '{print $4}')
          if [ $coverage -lt 80 ]; then
            echo "Coverage $coverage% is below 80%"
            exit 1
          fi
      
      - name: Check Documentation
        run: |
          if [ ! -f "README.md" ]; then
            echo "README.md is required"
            exit 1
          fi
      
      - name: Security Scan
        run: |
          composer audit
          docker run --rm -v $(pwd):/app securecodewarrior/sast-scan
```

### Quality Gates

**ุงูุจูุงุจุงุช:**
```
Commit โ Build โ Test โ Security โ Review โ Deploy
        โ       โ        โ          โ        โ
        โผ       โผ        โผ          โผ        โผ
      5 min   10 min   15 min     30 min   5 min
```

---

## 2.21 ุงูุชูููู ูุงูููุซูููุฉ: Resilience Patterns

### ุงูุฃููุงุท ุงูุฃุณุงุณูุฉ

#### 1. Circuit Breaker (ูุงุทุน ุงูุฏุงุฆุฑุฉ)

**ุงููุดููุฉ:**
ุฎุฏูุฉ ุจุทูุฆุฉ ุชุคุซุฑ ุนูู ูู ุงููุธุงู.

**ุงูุญู:**
```php
class PaymentCircuitBreaker {
    private const THRESHOLD = 5;
    private const TIMEOUT = 30;
    
    private int $failures = 0;
    private ?DateTime $lastFailure = null;
    private string $state = 'CLOSED'; // CLOSED, OPEN, HALF_OPEN
    
    public function call(callable $operation) {
        if ($this->state === 'OPEN') {
            if ($this->shouldRetry()) {
                $this->state = 'HALF_OPEN';
            } else {
                throw new CircuitOpenException();
            }
        }
        
        try {
            $result = $operation();
            $this->onSuccess();
            return $result;
        } catch (Exception $e) {
            $this->onFailure();
            throw $e;
        }
    }
    
    private function onFailure(): void {
        $this->failures++;
        $this->lastFailure = new DateTime();
        
        if ($this->failures >= self::THRESHOLD) {
            $this->state = 'OPEN';
        }
    }
    
    private function onSuccess(): void {
        $this->failures = 0;
        $this->state = 'CLOSED';
    }
}

// ุงูุงุณุชุฎุฏุงู
$breaker = new PaymentCircuitBreaker();
$result = $breaker->call(fn() => $paymentService->process($order));
```

#### 2. Bulkhead (ุงูุญุงุฌุฒ ุงููุงุฆู)

**ุงูููููู:**
ุนุฒู ุงูุฃุฌุฒุงุก ุญุชู ูุดู ุฌุฒุก ูุง ูุบุฑู ุงููู.

```php
class BulkheadExecutor {
    private int $maxConcurrent;
    private int $current = 0;
    private array $queue = [];
    
    public function __construct(int $maxConcurrent = 10) {
        $this->maxConcurrent = $maxConcurrent;
    }
    
    public function execute(callable $task) {
        if ($this->current >= $this->maxConcurrent) {
            throw new BulkheadFullException();
        }
        
        $this->current++;
        try {
            return $task();
        } finally {
            $this->current--;
        }
    }
}

// ูู ุฎุฏูุฉ ููุง ุญุฏูุฏูุง
$paymentBulkhead = new BulkheadExecutor(maxConcurrent: 20);
$inventoryBulkhead = new BulkheadExecutor(maxConcurrent: 50);
```

#### 3. Retry with Exponential Backoff

```php
class RetryPolicy {
    public function __construct(
        private int $maxAttempts = 3,
        private int $baseDelayMs = 100
    ) {}
    
    public function execute(callable $operation) {
        $attempt = 1;
        
        while ($attempt <= $this->maxAttempts) {
            try {
                return $operation();
            } catch (TransientException $e) {
                if ($attempt === $this->maxAttempts) {
                    throw $e;
                }
                
                $delay = $this->baseDelayMs * (2 ** $attempt);
                usleep($delay * 1000);
                $attempt++;
            }
        }
    }
}

// ุงูุงุณุชุฎุฏุงู
$retry = new RetryPolicy(maxAttempts: 3);
$result = $retry->execute(fn() => $api->call());
```

#### 4. Timeout

```php
class TimeoutExecutor {
    public function execute(callable $task, int $timeoutMs) {
        $result = null;
        $exception = null;
        
        $thread = new class($task, $result, $exception) extends Thread {
            public function run() {
                try {
                    $this->result = ($this->task)();
                } catch (Exception $e) {
                    $this->exception = $e;
                }
            }
        };
        
        $thread->start();
        $thread->join($timeoutMs);
        
        if ($thread->isRunning()) {
            $thread->kill();
            throw new TimeoutException();
        }
        
        if ($exception) {
            throw $exception;
        }
        
        return $result;
    }
}
```

### Dashboard ูููุฑุงูุจุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              System Health Dashboard                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Payment Service    โโโโโโโโโโ UP  (95% success)    โ
โ Inventory Service  โโโโโโโโโโ UP  (99% success)    โ
โ Shipping Service   โโโโโโโโโโ DEGRADED (slow)      โ
โ Notification       โโโโโโโโโโ UP  (98% success)    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Circuit Breakers:                                   โ
โ   - Payment: CLOSED                                 โ
โ   - Inventory: CLOSED                               โ
โ   - Shipping: HALF_OPEN (3 failures)                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Active Requests: 45/100                             โ
โ Queue Size: 12                                      โ
โ Avg Response Time: 120ms                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 2.22 ุงูุชูููู ูุงููุฑุงูุจุฉ: Observability

### ุงูุฃุฑูุงู ุงูุซูุงุซุฉ

#### 1. Metrics (ุงูููุงููุณ)

**ูุง ูููุณู:**
- **Golden Signals**:
  - Latency (ุงูุงุณุชุฌุงุจุฉ)
  - Traffic (ุงูุญุฑูุฉ)
  - Errors (ุงูุฃุฎุทุงุก)
  - Saturation (ุงูุชุดุจุน)

**ุชูููุฐ:**
```php
class MetricsCollector {
    public function recordRequest(Request $request, Response $response, float $duration): void {
        $this->prometheus->histogramObserve(
            'http_request_duration_seconds',
            $duration,
            [
                'method' => $request->getMethod(),
                'route' => $request->getRoute(),
                'status' => $response->getStatusCode()
            ]
        );
    }
    
    public function incrementError(string $type): void {
        $this->prometheus->incCounter('errors_total', ['type' => $type]);
    }
}
```

#### 2. Logging (ุงูุชุณุฌูู)

**ุงููููู:**
```json
{
    "timestamp": "2024-01-15T10:30:00Z",
    "level": "ERROR",
    "service": "payment-service",
    "trace_id": "abc123",
    "span_id": "def456",
    "message": "Payment processing failed",
    "context": {
        "order_id": "ORDER-123",
        "amount": 100.00,
        "currency": "USD",
        "error": "Insufficient funds"
    }
}
```

**ุงูุชุฏุฑุฌ:**
- DEBUG: ููุชุทููุฑ ููุท
- INFO: ุฃุญุฏุงุซ ุทุจูุนูุฉ
- WARN: ูุดุงูู ูุญุชููุฉ
- ERROR: ุฃุฎุทุงุก ุญููููุฉ

#### 3. Tracing (ุงูุชุชุจุน)

**Distributed Tracing:**
```
[Request] โ [API Gateway] โ [Order Service] โ [Payment Service]
    โ              โ               โ                 โ
    โ           10ms            50ms              100ms
    โ              โ               โ                 โ
    โโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโ
                   Total: 160ms
```

**ุชูููุฐ:**
```php
class TracedOperation {
    public function execute(callable $operation, string $name) {
        $span = $this->tracer->startSpan($name);
        
        try {
            $result = $operation();
            $span->setStatus(StatusCode::OK);
            return $result;
        } catch (Exception $e) {
            $span->setStatus(StatusCode::ERROR, $e->getMessage());
            $span->recordException($e);
            throw $e;
        } finally {
            $span->end();
        }
    }
}
```

### Correlation IDs

**ุงููุดููุฉ:**
ุทูุจ ูุงุญุฏ ููุฑ ุจู 5 ุฎุฏูุงุช. ููู ูุชุจุนูุ

**ุงูุญู:**
```php
class CorrelationIdMiddleware {
    public function handle(Request $request, callable $next) {
        $correlationId = $request->header('X-Correlation-ID') ?? uuid();
        
        // ุชูุฑูุฑ ููู ุงูุทูุจุงุช ุงูุฎุงุฑุฌูุฉ
        Context::set('correlation_id', $correlationId);
        
        // ุชุณุฌูู ูู ูู ููุงู
        Log::withContext(['correlation_id' => $correlationId]);
        
        $response = $next($request);
        $response->header('X-Correlation-ID', $correlationId);
        
        return $response;
    }
}
```

---

## 2.23 ุงูุชูููู ูุงูุจูุงูุงุช: ุงุณุชุฑุงุชูุฌูุงุช ูุชูุฏูุฉ

### Event Sourcing (ูุฑุงุฌุนุฉ ุนูููุฉ)

**ุงูููููู:**
ุงูุชุงุฑูุฎ ุงููุงูู ููููุงู:

```
Account-123:
  + AccountCreated (balance: 0)
  + MoneyDeposited (amount: 100, balance: 100)
  + MoneyWithdrawn (amount: 30, balance: 70)
  + MoneyDeposited (amount: 50, balance: 120)
  
ุงูุญุงูุฉ ุงูุญุงููุฉ: balance = 120
```

**ุงููุงุฆุฏุฉ:**
- Replay: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฃุญุฏุงุซ
- Audit: ูุฑุงุฌุนุฉ ูุงููุฉ
- Temporal queries: "ูุง ูุงู ุงูุฑุตูุฏ ูู 1 ููุงูุฑุ"

**ุงูุชูููุฐ:**
```php
class EventStore {
    public function append(string $streamId, array $events): void {
        $expectedVersion = $this->getCurrentVersion($streamId);
        
        foreach ($events as $event) {
            $this->db->insert('events', [
                'stream_id' => $streamId,
                'type' => get_class($event),
                'data' => json_encode($event),
                'version' => ++$expectedVersion,
                'occurred_at' => now()
            ]);
        }
        
        $this->publish($events);
    }
    
    public function readStream(string $streamId): array {
        return $this->db->query(
            "SELECT * FROM events WHERE stream_id = ? ORDER BY version",
            [$streamId]
        );
    }
}
```

### CQRS with Projections

**ููุงุฐุฌ ุงููุฑุงุกุฉ:**
```php
// Event Handler
class OrderProjectionHandler {
    public function onOrderCreated(OrderCreated $event): void {
        // ุฅุฏุฑุงุฌ ูู ูููุฐุฌ ุงููุฑุงุกุฉ
        $this->db->insert('order_summary', [
            'order_id' => $event->orderId,
            'customer_name' => $event->customerName,
            'total' => $event->total,
            'status' => 'pending',
            'created_at' => $event->occurredAt
        ]);
    }
    
    public function onOrderPaid(OrderPaid $event): void {
        $this->db->update('order_summary', 
            ['status' => 'paid', 'paid_at' => $event->occurredAt],
            ['order_id' => $event->orderId]
        );
    }
    
    public function onOrderShipped(OrderShipped $event): void {
        $this->db->update('order_summary',
            ['status' => 'shipped', 'tracking_number' => $event->trackingNumber],
            ['order_id' => $event->orderId]
        );
    }
}

// Query Handler
class GetOrderSummaryHandler {
    public function handle(GetOrderSummaryQuery $query): ?OrderSummary {
        $row = $this->db->fetchOne(
            "SELECT * FROM order_summary WHERE order_id = ?",
            $query->orderId
        );
        
        return $row ? OrderSummary::fromArray($row) : null;
    }
}
```

### Data Consistency Patterns

#### 1. Saga (ูุฑุงุฌุนุฉ)
ุงูุชูุณูู ุนุจุฑ ุงูุฎุฏูุงุช:

```php
class DistributedSaga {
    private array $steps = [];
    private array $compensations = [];
    
    public function step(string $name, callable $action, callable $compensation): self {
        $this->steps[$name] = $action;
        $this->compensations[$name] = $compensation;
        return $this;
    }
    
    public function execute(): SagaResult {
        $completed = [];
        
        try {
            foreach ($this->steps as $name => $action) {
                $action();
                $completed[] = $name;
            }
            
            return SagaResult::success();
            
        } catch (Exception $e) {
            // Compensate in reverse order
            foreach (array_reverse($completed) as $name) {
                try {
                    ($this->compensations[$name])();
                } catch (Exception $compensationError) {
                    // Log for manual intervention
                    $this->alert("Compensation failed: $name");
                }
            }
            
            return SagaResult::failure($e);
        }
    }
}

// ุงูุงุณุชุฎุฏุงู
$saga = (new DistributedSaga())
    ->step('reserve_inventory', 
        fn() => $inventory->reserve($items),
        fn() => $inventory->release($items)
    )
    ->step('process_payment',
        fn() => $payment->charge($amount),
        fn() => $payment->refund($amount)
    )
    ->step('create_shipment',
        fn() => $shipping->create($order),
        fn() => $shipping->cancel($order)
    );

$result = $saga->execute();
```

#### 2. Outbox Pattern

**ุงููุดููุฉ:**
```php
// ูุฐุง ุฎุทุฑ!
$db->beginTransaction();
$db->insert('orders', $order);
$kafka->publish('order_created', $order); // ูุฏ ููุดู!
$db->commit();
```

**ุงูุญู:**
```php
// 1. ุงุญูุธ ูู ููุณ ูุงุนุฏุฉ ุงูุจูุงูุงุช
$db->beginTransaction();
$db->insert('orders', $order);
$db->insert('outbox', [
    'type' => 'order_created',
    'payload' => json_encode($order),
    'created_at' => now()
]);
$db->commit();

// 2. ูุนุงูุฌ ูููุตู ูุฑุณู ููู message broker
class OutboxProcessor {
    public function process(): void {
        $messages = $this->db->fetchAll(
            "SELECT * FROM outbox WHERE processed_at IS NULL ORDER BY created_at"
        );
        
        foreach ($messages as $message) {
            try {
                $this->eventBus->publish($message['type'], $message['payload']);
                $this->db->update('outbox', 
                    ['processed_at' => now()],
                    ['id' => $message['id']]
                );
            } catch (Exception $e) {
                // ุณูุนูุฏ ุงููุญุงููุฉ ูุงุญูุงู
                $this->logger->error("Failed to publish: " . $e->getMessage());
            }
        }
    }
}
```

---

*ูุชุจุน ุงูุฌุฒุก ุงูุฃุฎูุฑ...*


---

## 2.24 ุงูุชูููู ูุงูุชูููุฉ: ุชุญููู ูุงูู

### ุงูุชูููุฉ ุงูุญููููุฉ ููุชูููู

#### ุงูุชูููุฉ ุงูุฃูููุฉ
```
ุนุงู 1:
โโโ ูุฑูู ุฅุถุงูู: 5 ูุทูุฑูู ร 12 ุดูุฑ = $600,000
โโโ ุจููุฉ ุชุญุชูุฉ: Cloud, Monitoring = $50,000
โโโ ุชุฏุฑูุจ: $20,000
โโโ ููุฏุงู ุงูุฅูุชุงุฌูุฉ: 30% ร 12 ุดูุฑ = $180,000
                              Total: $850,000

ุนุงู 2-3:
โโโ ุงุณุชูุฑุงุฑ ุงูุชุทููุฑ: $400,000/ุณูุฉ
โโโ ุตูุงูุฉ ูุฒุฏูุฌุฉ: $100,000/ุณูุฉ
โโโ ุฃุฏูุงุช ููุฑุงูุจุฉ: $30,000/ุณูุฉ
```

#### ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ (ROI)

**ูุจู ุงูุชูููู:**
- ุชุบููุฑ ุจุณูุท: 5 ุฃูุงู
- ุฃุฎุทุงุก ุงูุฅูุชุงุฌ: 10/ุดูุฑ
- ููุช ุงููุดุฑ: 6 ุณุงุนุงุช

**ุจุนุฏ 3 ุณููุงุช:**
- ุชุบููุฑ ุจุณูุท: 1 ููู (**80% ุชุญุณู**)
- ุฃุฎุทุงุก ุงูุฅูุชุงุฌ: 2/ุดูุฑ (**80% ุชุญุณู**)
- ููุช ุงููุดุฑ: 30 ุฏูููุฉ (**90% ุชุญุณู**)

**ุงูุชูููุฑ ุงูุณููู:**
- ุณุฑุนุฉ ุงูุชุทููุฑ: $300,000
- ุฎูุถ ุงูุฃุฎุทุงุก: $150,000
- ููุงุกุฉ ุงููุดุฑ: $50,000
- **ุงูุฅุฌูุงูู: $500,000/ุณูุฉ**

**ูุชุฑุฉ ุงูุงุณุชุฑุฏุงุฏ:** 1.7 ุณูุฉ

### ูุชู ูุง ุชููููุ

**ูุง ุชูููู ุฅุฐุง:**
1. ูุฑููู < 10 ูุทูุฑูู
2. ููุชุฌู MVP/ูุงุดุฆ
3. ูุง ุชูุฌุฏ ูุดุงูู ูุงุถุญุฉ
4. ุงูุถุบุท ุงูุชุฌุงุฑู ูููุน ุงูุงุณุชุซูุงุฑ

**ุญูู:**
> "ุฅุฐุง ูู ููู ููุณูุฑุงูุ ูุง ุชุตูุญู. ููู ุฅุฐุง ูุงู ููุณูุฑุงูุ ููุฑ ูููุงู ูุจู ุฃู ุชุตูุญู."

---

## 2.25 ุงูุชูููู ูุงูุซูุงูุฉ: ุงูุชุญูู ุงูุชูุธููู

### ุงูุชุญูู ููุณ ุชูููุงู ููุท

**ุงููุซูุซ:**
```
         People
          /\
         /  \
        /    \
       /      \
      /        \
     /__________\
Process    Technology
```

### ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุบููุฑ

#### 1. ุงูุชุนููู ุงููุณุชูุฑ
- **Tech Talks**: ุฃุณุจูุนูุงู
- **Book Club**: ุงูุฑุฃูุง Domain-Driven Design ูุนุงู
- **Workshops**: Event Storming ุนููู

#### 2. Communities of Practice
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ    Frontend Community               โ
โ    - React, Vue, Angular            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ    Backend Community                โ
โ    - DDD, Microservices, APIs       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ    DevOps Community                 โ
โ    - CI/CD, K8s, Monitoring         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### 3. Showcases (ุนุฑูุถ)
ูู ุดูุฑ:
- ูุฑูู ูุนุฑุถ ูุง ุจูุชู
- ุงููุดุงูู ุงูุชู ูุงุฌูุชูุง
- ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

#### 4. Rotation (ุชุฏููุฑ)
- ูุทูุฑ ูุนูู ูู ุณูุงู ูุฎุชูู ูู 6 ุฃุดูุฑ
- ูููู ุงููุนุฑูุฉ
- ููุณุฑ ุงูุตูุงูุน

### ูููุงุณ ุงููุถุฌ

```
ุงููุณุชูู 1: ูุฑุฏู
โโโ ูููู ุงูููุงููู
โโโ ูุทุจู ูู ุนููู

ุงููุณุชูู 2: ูุฑููู
โโโ ูุนูู ุงูุขุฎุฑูู
โโโ ูุฑุงุฌุน ููุฏ ุงูุฒููุงุก
โโโ ูููุฏ ุงููุฑุงุฑุงุช

ุงููุณุชูู 3: ุชูุธููู
โโโ ููุชุจ ุงูุฃุฏูุงุช
โโโ ูุถุน ุงููุนุงููุฑ
โโโ ูุชุญุฏุซ ูู ุงููุคุชูุฑุงุช
```

---

## 2.26 ุงูุชูููู ูุงููุณุชูุจู: 2025-2030

### ุงูุงุชุฌุงูุงุช ุงููุชููุนุฉ

#### 1. AI-Assisted Architecture
```
ุงููุนูุงุฑู โโ AI Assistant
    โ          โ
    โ          โโโบ ููุชุฑุญ ุฃููุงุท
    โ          โโโบ ูุญูู ุงูููุฏ
    โ          โโโบ ูุชูุจุฃ ุจุงููุดุงูู
    โ
    โโโบ ููุฑุฑ
    โโโบ ูุตูู
    โโโบ ูููุฏ
```

**ุงูุฃุฏูุงุช:**
- GitHub Copilot ููุจููุฉ
- AI ูููุฏ diagrams
- AI ูุญูู ุงูู coupling

#### 2. WebAssembly Components
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Component A (Rust)             โ
โ         โ๏ธ WIT Interface            โ
โ      Component B (Go)               โ
โ         โ๏ธ WIT Interface            โ
โ      Component C (Python)           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููุงุฆุฏุฉ:**
- ูุบุงุช ูุฎุชููุฉ ุชุชุนุงูู
- ุฃุฏุงุก ูุฑูุจ ูู ุงูุฃุตูู
- ุนุฒู ุฃูุงูู

#### 3. Sustainable Architecture
```
ููุงุกุฉ ุงูุทุงูุฉ โโ ุชุตููู ุฃูุถู
    โ
    โโ> ุฃูู servers
    โโ> ุงุณุชุบูุงู ุฃูุถู ููููุงุฑุฏ
    โโ> ุฃูู carbon footprint
```

---

## 2.27 ุญูุงุฑ ูุน ููุณู: ุงุณุชุฑุงุชูุฌูุฉ ุงููุฑุงุฑ

### ูุงุฆูุฉ ุงูุฃุณุฆูุฉ ูุจู ุงูุชูููู

**ุงููุณู 1: ุงูุฌุงูุฒูุฉ**
- [ ] ูู ูููุช ุงููุดููุฉ ูุนูุงูุ
- [ ] ูู ุฌุฑุจุช ุงูุญููู ุงูุฃุจุณุทุ
- [ ] ูู ุงููุฑูู ุฌุงูุฒุ
- [ ] ูู ุงูุฅุฏุงุฑุฉ ุชุฏุนูุ

**ุงููุณู 2: ุงูุชุตููู**
- [ ] ูู ุญุฏุฏุช Bounded Contextsุ
- [ ] ูู ุฑุณูุช Context Mapุ
- [ ] ูู ุญุฏุฏุช ููุงุท ุงูุงุชุตุงูุ
- [ ] ูู ุฎุทุทุช ููุจูุงูุงุชุ

**ุงููุณู 3: ุงูุชูููุฐ**
- [ ] ูุง ุฃูู ุฎุฏูุฉ ุณุชุณุชุฎุฑุฌุ
- [ ] ูุง ุฎุทุฉ ุงูุชุฑุงุฌุนุ
- [ ] ููู ุณุชุฎุชุจุฑุ
- [ ] ููู ุณุชูุนูู ุงููุฑููุ

### ูุฑุตุฏ ุงููุฑุงุฑ

| ุงูุนุงูู | ุงุณุชูุฑ | ุฃููู | ููุฑ |
|--------|-------|------|-----|
| ููู ุงููุฌุงู | โ | | |
| ููุงุฑุฏ ูุงููุฉ | โ | | |
| ุถุบุท ููุฑู | | โ | |
| ูุฑูู ุฌุฏูุฏ | | | โ |
| ุจููุฉ ุถุนููุฉ | โ | | |

---

## 2.28 ุงูุชุฌููุน ุงูููุงุฆู: ูุธุงู ุดุงูู

### ุงูุจููุฉ ุงููุฑุฌุนูุฉ ุงููุงููุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        API Gateway                              โ
โ            (Auth, Rate Limit, Routing, Caching)                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
        โโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
        โ                โ                โ
        โผ                โผ                โผ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โ   Service A  โ  โ   Service B  โ  โ   Service C  โ
โ  โโโโโโโโโโ  โ  โ  โโโโโโโโโโ  โ  โ  โโโโโโโโโโ  โ
โ  โDomain  โ  โ  โ  โDomain  โ  โ  โ  โDomain  โ  โ
โ  โโโโโโโโโโค  โ  โ  โโโโโโโโโโค  โ  โ  โโโโโโโโโโค  โ
โ  โApp     โ  โ  โ  โApp     โ  โ  โ  โApp     โ  โ
โ  โโโโโโโโโโค  โ  โ  โโโโโโโโโโค  โ  โ  โโโโโโโโโโค  โ
โ  โInfra   โ  โ  โ  โInfra   โ  โ  โ  โInfra   โ  โ
โ  โโโโโโโโโโ  โ  โ  โโโโโโโโโโ  โ  โ  โโโโโโโโโโ  โ
โโโโโโโโฌโโโโโโโโ  โโโโโโโโฌโโโโโโโโ  โโโโโโโโฌโโโโโโโโ
       โ                 โ                 โ
       โโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโ
                         โ
        โโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
        โ                โ                โ
        โผ                โผ                โผ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โ   Events     โ  โ   Read DB    โ  โ   Monitoring โ
โ   (Kafka)    โ  โ  (Projections)โ  โ(Prometheus) โ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
```

### ููุญุฉ ุงูููุงู

| ุงููููุฉ | ุงูุฃููููุฉ | ุงููุฏุฉ | ุงููุณุคูู |
|--------|----------|-------|---------|
| ูุตู ูุงุนุฏุฉ ุงูุจูุงูุงุช | ๐ด ุนุงููุฉ | 3 ุฃุดูุฑ | ูุฑูู ุงูุจููุฉ |
| ุงุณุชุฎุฑุงุฌ Payment Service | ๐ด ุนุงููุฉ | 6 ุฃุดูุฑ | ูุฑูู ุงูุฏูุน |
| ุจูุงุก API Gateway | ๐ก ูุชูุณุทุฉ | 2 ุฃุดูุฑ | ูุฑูู ุงูุจููุฉ |
| ุฅุนุฏุงุฏ Monitoring | ๐ก ูุชูุณุทุฉ | 1 ุดูุฑ | ูุฑูู DevOps |
| ุชุฏุฑูุจ ุงููุฑู | ๐ข ููุฎูุถุฉ | ูุณุชูุฑ | Tech Leads |

---

## ุฎุงุชูุฉ ุงููุตู ุงูุซุงูู: ุงููุณุฎุฉ ุงููุงููุฉ

### ุงูุฅูุฌุงุฒ

ููุฏ ุบุทููุง ูู ูุฐุง ุงููุตู ุงูููุณุน:

1. **ุฃุณุณ ุงูุชูููู** - ุงููุจุงุฏุฆ ูุงููุธุฑูุงุช
2. **ุงูุงุณุชุฑุงุชูุฌูุงุช** - 4 ุทุฑู ููุชูููู
3. **ุงูููุงุฐุฌ** - MVC ูู Clean Architecture
4. **ุงูุฃููุงุท ุงููุชูุฏูุฉ** - Strangler, ACL, Saga
5. **ุงูุฏุฑุงุณุงุช ุงูุนูููุฉ** - Laravel, Uber, Shopify
6. **ุงูุงุฎุชุจุงุฑ** - CDC, Contract Testing
7. **Anti-Patterns** - ููู ูุชุฌูุจ ุงูุฃุฎุทุงุก
8. **ุงููุฌุฑุฉ** - 3 ุงุณุชุฑุงุชูุฌูุงุช
9. **ุงูุฃุฏูุงุช** - Event Storming, C4, ADRs
10. **ุงูุฃูุงู ูุงูุฃุฏุงุก** - Defense in Depth, Caching
11. **ุงููุฑุงูุจุฉ** - Metrics, Logging, Tracing
12. **ุงูุจูุงูุงุช** - Event Sourcing, CQRS
13. **ุงูุชูููุฉ** - ROI Analysis
14. **ุงูุซูุงูุฉ** - ุงูุชุญูู ุงูุชูุธููู
15. **ุงููุณุชูุจู** - AI, WebAssembly

### ุงูุฑูู ุงูููุงุณู

- **ุงููููุงุช**: ุฃูุซุฑ ูู 10,000 ูููุฉ
- **ุงูุฃูุณุงู**: 28 ูุณู
- **ุงูุฃูุซูุฉ ุงูุจุฑูุฌูุฉ**: 30+ ูุซุงู
- **ุฏุฑุงุณุงุช ุงูุญุงูุฉ**: 5 ุฏุฑุงุณุงุช

### ุฑุณุงูุฉ ุงูุฎุชุงู

> "ุงูุชูููู ููุณ ูุฏูุงูุ ุจู ูุณููุฉ. ุงููุณููุฉ ุงูุตุญูุญุฉ ูููุดููุฉ ุงูุตุญูุญุฉ ูู ุงูููุช ุงูุตุญูุญ."

ุงููุนูุงุฑู ุงูุญูููู ูุนุฑู **ูุชู** ูููููุ **ููู** ูููููุ ู**ููุงุฐุง** ููููู.

---

## ููุฑุณ ุดุงูู

### ุงูุฌุฒุก ุงูุฃูู: ุงูุฃุณุงุณูุงุช
- 2.1 ุฃุณุณ ุงูุชูููู ุงููุนูุงุฑู
- 2.2 ุงุณุชุฑุงุชูุฌูุงุช ุงูุชูููู
- 2.3 ููุงุฐุฌ ุงูุชูููู ุงูุดุงุฆุนุฉ

### ุงูุฌุฒุก ุงูุซุงูู: ุงูุชุทุจูู ุงูุนููู
- 2.4 ุงูุชูููู ูู PHP
- 2.5 ุฃููุงุท ุงูุชูููู ุงููุชูุฏูุฉ
- 2.6 ุฏุฑุงุณุฉ ุญุงูุฉ: ูุธุงู ุงูุชุฌุงุฑุฉ

### ุงูุฌุฒุก ุงูุซุงูุซ: ุงูุฌูุฏุฉ ูุงูููุซูููุฉ
- 2.7 ุงุฎุชุจุงุฑ ุงูุฃูุธูุฉ ุงููููููุฉ
- 2.8 ููุณูุฉ ุงูุชูููู
- 2.9 ููุงูุญุฉ Anti-Patterns
- 2.10 ุงุณุชุฑุงุชูุฌูุงุช ุงููุฌุฑุฉ
- 2.11 ุฃุฏูุงุช ุงูุชูููู
- 2.12 ููุงุจูุฉ ูุน ูุนูุงุฑู
- 2.13 ุชูุงุฑูู ุนูููุฉ

### ุงูุฌุฒุก ุงูุฑุงุจุน: ุงูููุงุถูุน ุงููุชูุฏูุฉ
- 2.14 ุฏุฑุงุณุงุช ุญุงูุฉ ูุชุนุฏุฏุฉ
- 2.15 ุงูุชูููู ูุงูุฃูุงู
- 2.16 ุงูุชูููู ูุงูุฃุฏุงุก
- 2.17 ุงูุชูููู ูุงููุฑู
- 2.18 ูุณุชูุจู ุงูุชูููู
- 2.19 ุฑุณุงูุฉ ุฎุชุงููุฉ

### ุงูุฌุฒุก ุงูุฎุงูุณ: ุงูุชูููุฐ ุงูุดุงูู
- 2.20 ุงูุฌูุฏุฉ ูุงููุนุงููุฑ
- 2.21 Resilience Patterns
- 2.22 ุงููุฑุงูุจุฉ
- 2.23 ุงุณุชุฑุงุชูุฌูุงุช ุงูุจูุงูุงุช
- 2.24 ุงูุชูููุฉ
- 2.25 ุงูุซูุงูุฉ
- 2.26 ุงููุณุชูุจู
- 2.27 ุงุณุชุฑุงุชูุฌูุฉ ุงููุฑุงุฑ
- 2.28 ุงููุธุงู ุงูุดุงูู

---

**ยฉ 2025 ูุญูุฏ ุงูุนุจูุฏ | ุงููุนูุงุฑู**

*"ุงูุณูุงุฏุฉ ุงูุญููููุฉ ุนูู ุญุฑูุชู"*

**ููุงูุฉ ุงููุตู ุงูุซุงูู - ุงูุฅุตุฏุงุฑ ุงููุงูู**
**40+ ุตูุญุฉ | 28 ูุณู | ุฏุฑุงุณุงุช ูุชุนุฏุฏุฉ**

---

**ุฅูู ุงููุตู ุงูุซุงูุซ: ุณูููููุฌูุฉ ุงููุนูุงุฑู**
*"ุนูููุฉ ุงููููุฏุณ ุงููุนูุงุฑู"*


---

## 2.29 ุฃูุซูุฉ ุจุฑูุฌูุฉ ูุงููุฉ: ูุธุงู ุงูุญุฌูุฒุงุช

### ุงูุณููุงุฑูู
ูุธุงู ุญุฌุฒ ุชุฐุงูุฑ ุทูุฑุงู ูุนูุฏ

### ุงูุจููุฉ
```
Flight Booking System
โโโ Reservation Context
โโโ Payment Context
โโโ Inventory Context
โโโ Notification Context
```

### ุงูููุฏ ุงููุงูู

**1. Value Objects:**
```php
// src/Domain/Reservation/ValueObject/FlightNumber.php
final class FlightNumber {
    private function __construct(
        private string $airlineCode,
        private string $number
    ) {
        Assert::length($airlineCode, 2);
        Assert::regex($number, '/^\d{1,4}$/');
    }
    
    public static function fromString(string $flightNumber): self {
        $parts = explode('-', $flightNumber);
        return new self($parts[0], $parts[1]);
    }
    
    public function toString(): string {
        return "{$this->airlineCode}-{$this->number}";
    }
    
    public function getAirlineCode(): string {
        return $this->airlineCode;
    }
}

// src/Domain/Reservation/ValueObject/SeatNumber.php
final class SeatNumber {
    private function __construct(
        private string $row,
        private string $seat
    ) {}
    
    public static function fromString(string $seat): self {
        preg_match('/^(\d{1,3})([A-F])$/', $seat, $matches);
        return new self($matches[1], $matches[2]);
    }
    
    public function isEmergencyExit(): bool {
        return in_array($this->row, ['10', '11', '28', '29']);
    }
    
    public function isWindow(): bool {
        return in_array($this->seat, ['A', 'F']);
    }
}

// src/Domain/Reservation/ValueObject/Money.php
final class Money {
    private function __construct(
        private int $amount, // ุจุงูุณูุช
        private Currency $currency
    ) {}
    
    public static function fromDecimal(float $amount, Currency $currency): self {
        return new self((int)($amount * 100), $currency);
    }
    
    public function add(Money $other): self {
        $this->assertSameCurrency($other);
        return new Money($this->amount + $other->amount, $this->currency);
    }
    
    public function multiply(float $factor): self {
        return new Money((int)($this->amount * $factor), $this->currency);
    }
    
    public function toDecimal(): float {
        return $this->amount / 100;
    }
    
    public function format(): string {
        return number_format($this->toDecimal(), 2) . ' ' . $this->currency->value;
    }
}
```

**2. Entities:**
```php
// src/Domain/Reservation/Entity/Reservation.php
class Reservation {
    private array $domainEvents = [];
    
    private function __construct(
        private ReservationId $id,
        private FlightNumber $flightNumber,
        private Passenger $passenger,
        private SeatNumber $seat,
        private Money $price,
        private ReservationStatus $status,
        private ?DateTime $confirmedAt = null
    ) {}
    
    public static function create(
        ReservationId $id,
        FlightNumber $flightNumber,
        Passenger $passenger,
        SeatNumber $seat,
        Money $price
    ): self {
        $reservation = new self(
            $id,
            $flightNumber,
            $passenger,
            $seat,
            $price,
            ReservationStatus::pending()
        );
        
        $reservation->recordEvent(new ReservationCreated($id, $flightNumber, $passenger));
        return $reservation;
    }
    
    public function confirm(PaymentId $paymentId): void {
        if (!$this->status->isPending()) {
            throw new InvalidStateTransitionException();
        }
        
        $this->status = ReservationStatus::confirmed();
        $this->confirmedAt = new DateTime();
        
        $this->recordEvent(new ReservationConfirmed($this->id, $paymentId));
    }
    
    public function cancel(string $reason): void {
        if ($this->status->isConfirmed() && $this->isWithin24Hours()) {
            throw new LateCancellationException();
        }
        
        $this->status = ReservationStatus::cancelled();
        $this->recordEvent(new ReservationCancelled($this->id, $reason));
    }
    
    public function changeSeat(SeatNumber $newSeat, Money $additionalFee): void {
        if (!$this->status->isConfirmed()) {
            throw new ReservationNotConfirmedException();
        }
        
        $oldSeat = $this->seat;
        $this->seat = $newSeat;
        $this->price = $this->price->add($additionalFee);
        
        $this->recordEvent(new SeatChanged($this->id, $oldSeat, $newSeat, $additionalFee));
    }
    
    public function getId(): ReservationId {
        return $this->id;
    }
    
    public function getStatus(): ReservationStatus {
        return $this->status;
    }
    
    public function releaseEvents(): array {
        $events = $this->domainEvents;
        $this->domainEvents = [];
        return $events;
    }
    
    private function recordEvent(DomainEvent $event): void {
        $this->domainEvents[] = $event;
    }
    
    private function isWithin24Hours(): bool {
        $now = new DateTime();
        $diff = $now->diff($this->confirmedAt);
        return $diff->h < 24 && $diff->days === 0;
    }
}

// src/Domain/Reservation/Entity/Passenger.php
class Passenger {
    public function __construct(
        private PassengerId $id,
        private Name $name,
        private PassportNumber $passport,
        private Email $email,
        private ?FrequentFlyerNumber $ffn = null
    ) {}
    
    public function updateEmail(Email $newEmail): void {
        $this->email = $newEmail;
    }
    
    public function linkFrequentFlyer(FrequentFlyerNumber $ffn): void {
        $this->ffn = $ffn;
    }
    
    public function isFrequentFlyer(): bool {
        return $this->ffn !== null;
    }
}
```

**3. Domain Services:**
```php
// src/Domain/Reservation/Service/PricingService.php
interface PricingService {
    public function calculatePrice(
        FlightNumber $flight,
        SeatNumber $seat,
        Passenger $passenger,
        DateTime $bookingDate
    ): Money;
}

class DynamicPricingService implements PricingService {
    public function __construct(
        private FlightInventory $inventory,
        private DemandForecast $forecast
    ) {}
    
    public function calculatePrice(
        FlightNumber $flight,
        SeatNumber $seat,
        Passenger $passenger,
        DateTime $bookingDate
    ): Money {
        $basePrice = $this->inventory->getBasePrice($flight);
        
        // ุนุงูู ุงูููุนุฏ
        $seatFactor = $seat->isBusiness() ? 2.5 : 1.0;
        if ($seat->isEmergencyExit()) {
            $seatFactor *= 1.1;
        }
        if ($seat->isWindow()) {
            $seatFactor *= 1.05;
        }
        
        // ุนุงูู ุงูุทูุจ
        $demandFactor = $this->forecast->getDemandFactor($flight, $bookingDate);
        
        // ุฎุตู ุงููุณุงูุฑ ุงูุฏุงุฆู
        $loyaltyDiscount = $passenger->isFrequentFlyer() ? 0.9 : 1.0;
        
        $finalPrice = $basePrice
            ->multiply($seatFactor)
            ->multiply($demandFactor)
            ->multiply($loyaltyDiscount);
        
        return $finalPrice;
    }
}
```

**4. Application Services:**
```php
// src/Application/Reservation/BookFlightUseCase.php
class BookFlightUseCase {
    public function __construct(
        private ReservationRepository $reservations,
        private FlightInventory $inventory,
        private PricingService $pricing,
        private PaymentGateway $payment,
        private EventBus $events
    ) {}
    
    public function execute(BookFlightCommand $command): ReservationResult {
        // ุงูุชุญูู ูู ุชููุฑ ุงูููุนุฏ
        if (!$this->inventory->isSeatAvailable($command->flightNumber, $command->seat)) {
            return ReservationResult::seatUnavailable();
        }
        
        // ุญุฌุฒ ุงูููุนุฏ ูุคูุชุงู
        $this->inventory->holdSeat($command->flightNumber, $command->seat, $command->passenger->getId());
        
        try {
            // ุญุณุงุจ ุงูุณุนุฑ
            $price = $this->pricing->calculatePrice(
                $command->flightNumber,
                $command->seat,
                $command->passenger,
                new DateTime()
            );
            
            // ุฅูุดุงุก ุงูุญุฌุฒ
            $reservation = Reservation::create(
                ReservationId::generate(),
                $command->flightNumber,
                $command->passenger,
                $command->seat,
                $price
            );
            
            // ูุนุงูุฌุฉ ุงูุฏูุน
            $payment = $this->payment->process(new PaymentRequest(
                amount: $price,
                method: $command->paymentMethod,
                reference: $reservation->getId()->toString()
            ));
            
            if (!$payment->isSuccessful()) {
                $this->inventory->releaseSeat($command->flightNumber, $command->seat);
                return ReservationResult::paymentFailed($payment->getError());
            }
            
            // ุชุฃููุฏ ุงูุญุฌุฒ
            $reservation->confirm($payment->getId());
            $this->reservations->save($reservation);
            
            // ูุดุฑ ุงูุฃุญุฏุงุซ
            foreach ($reservation->releaseEvents() as $event) {
                $this->events->publish($event);
            }
            
            return ReservationResult::success($reservation->getId());
            
        } catch (Exception $e) {
            $this->inventory->releaseSeat($command->flightNumber, $command->seat);
            throw $e;
        }
    }
}

// src/Application/Reservation/ChangeSeatUseCase.php
class ChangeSeatUseCase {
    public function __construct(
        private ReservationRepository $reservations,
        private FlightInventory $inventory,
        private PricingService $pricing,
        private PaymentGateway $payment,
        private EventBus $events
    ) {}
    
    public function execute(ChangeSeatCommand $command): SeatChangeResult {
        $reservation = $this->reservations->find($command->reservationId);
        if (!$reservation) {
            throw new ReservationNotFoundException();
        }
        
        // ุงูุชุญูู ูู ุงูููุนุฏ ุงูุฌุฏูุฏ
        if (!$this->inventory->isSeatAvailable($reservation->getFlightNumber(), $command->newSeat)) {
            return SeatChangeResult::seatUnavailable();
        }
        
        // ุญุณุงุจ ุงููุฑู ูู ุงูุณุนุฑ
        $currentPrice = $reservation->getPrice();
        $newSeatPrice = $this->pricing->calculateSeatPrice(
            $reservation->getFlightNumber(),
            $command->newSeat
        );
        $priceDifference = $newSeatPrice->subtract($currentPrice);
        
        // ุฏูุน ุงููุฑู ุฅุฐุง ูุฒู
        if ($priceDifference->isPositive()) {
            $payment = $this->payment->process(new PaymentRequest(
                amount: $priceDifference,
                method: $command->paymentMethod,
                reference: "SEAT_CHANGE_{$reservation->getId()}"
            ));
            
            if (!$payment->isSuccessful()) {
                return SeatChangeResult::paymentFailed();
            }
        }
        
        // ุชุญุฏูุซ ุงูููุนุฏ
        $oldSeat = $reservation->getSeat();
        $reservation->changeSeat($command->newSeat, $priceDifference);
        
        // ุชุญุฏูุซ ุงููุฎุฒูู
        $this->inventory->releaseSeat($reservation->getFlightNumber(), $oldSeat);
        $this->inventory->allocateSeat($reservation->getFlightNumber(), $command->newSeat);
        
        $this->reservations->save($reservation);
        
        foreach ($reservation->releaseEvents() as $event) {
            $this->events->publish($event);
        }
        
        return SeatChangeResult::success($command->newSeat);
    }
}
```

**5. Infrastructure:**
```php
// src/Infrastructure/Persistence/DoctrineReservationRepository.php
class DoctrineReservationRepository implements ReservationRepository {
    public function __construct(
        private EntityManager $em
    ) {}
    
    public function save(Reservation $reservation): void {
        $this->em->persist($reservation);
        $this->em->flush();
    }
    
    public function find(ReservationId $id): ?Reservation {
        return $this->em->find(Reservation::class, $id);
    }
    
    public function findByFlight(FlightNumber $flight): array {
        return $this->em->createQuery(
            'SELECT r FROM Reservation r WHERE r.flightNumber = :flight'
        )->setParameter('flight', $flight->toString())->getResult();
    }
}

// src/Infrastructure/Messaging/KafkaEventBus.php
class KafkaEventBus implements EventBus {
    public function __construct(
        private Producer $kafkaProducer,
        private string $topicPrefix = 'flight_booking'
    ) {}
    
    public function publish(DomainEvent $event): void {
        $topic = "{$this->topicPrefix}." . $this->getEventTopic($event);
        
        $message = json_encode([
            'type' => get_class($event),
            'payload' => $event->toArray(),
            'occurred_at' => $event->occurredAt()->format('c'),
            'correlation_id' => Context::getCorrelationId()
        ]);
        
        $this->kafkaProducer->send([
            'topic' => $topic,
            'value' => $message,
            'key' => $event->getAggregateId()
        ]);
    }
    
    private function getEventTopic(DomainEvent $event): string {
        return match(true) {
            $event instanceof ReservationEvent => 'reservations',
            $event instanceof PaymentEvent => 'payments',
            $event instanceof InventoryEvent => 'inventory',
            default => 'general'
        };
    }
}
```

**6. API Layer:**
```php
// src/Infrastructure/Http/Controller/ReservationController.php
#[Route('/api/v1/reservations')]
class ReservationController {
    public function __construct(
        private BookFlightUseCase $bookFlight,
        private ChangeSeatUseCase $changeSeat,
        private CancelReservationUseCase $cancelReservation
    ) {}
    
    #[Route('', methods: ['POST'])]
    public function book(Request $request): JsonResponse {
        $command = new BookFlightCommand(
            flightNumber: FlightNumber::fromString($request->get('flight_number')),
            passenger: new Passenger(
                PassengerId::generate(),
                Name::fromString($request->get('passenger_name')),
                PassportNumber::fromString($request->get('passport')),
                Email::fromString($request->get('email'))
            ),
            seat: SeatNumber::fromString($request->get('seat')),
            paymentMethod: PaymentMethod::fromString($request->get('payment_method'))
        );
        
        $result = $this->bookFlight->execute($command);
        
        return match($result->getStatus()) {
            ReservationStatus::SUCCESS => new JsonResponse([
                'reservation_id' => $result->getReservationId()->toString(),
                'status' => 'confirmed'
            ], 201),
            ReservationStatus::SEAT_UNAVAILABLE => new JsonResponse([
                'error' => 'Selected seat is no longer available'
            ], 409),
            ReservationStatus::PAYMENT_FAILED => new JsonResponse([
                'error' => 'Payment processing failed',
                'details' => $result->getPaymentError()
            ], 402),
            default => new JsonResponse(['error' => 'Unknown error'], 500)
        };
    }
    
    #[Route('/{id}/seat', methods: ['PUT'])]
    public function changeSeat(string $id, Request $request): JsonResponse {
        $command = new ChangeSeatCommand(
            reservationId: ReservationId::fromString($id),
            newSeat: SeatNumber::fromString($request->get('new_seat')),
            paymentMethod: PaymentMethod::fromString($request->get('payment_method'))
        );
        
        $result = $this->changeSeat->execute($command);
        
        return new JsonResponse([
            'new_seat' => $result->getSeat()->toString(),
            'price_difference' => $result->getPriceDifference()->toDecimal()
        ]);
    }
}
```

---



---

## 2.30 ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ: ุชุตูุฑ ุงูุจููุฉ

### C4 Model ูุงููุงู

#### Level 1: System Context

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    System Context                           โ
โ                     Flight Booking                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  โโโโโโโโโโโโ      โโโโโโโโโโโโโโโโ      โโโโโโโโโโโโ      โ
โ  โ Passengerโโโโโโโถโ Flight Bookingโโโโโโโโ Airline  โ      โ
โ  โ (User)   โ      โ    System     โ      โ Staff    โ      โ
โ  โโโโโโโโโโโโ      โโโโโโโโโฌโโโโโโโโ      โโโโโโโโโโโโ      โ
โ                            โ                                โ
โ                            โ                                โ
โ              โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ                 โ
โ              โผ             โผ             โผ                 โ
โ        โโโโโโโโโโโ   โโโโโโโโโโโ   โโโโโโโโโโโ            โ
โ        โ Payment โ   โInventoryโ   โ Notification        โ
โ        โ Gateway โ   โ System  โ   โ Service  โ            โ
โ        โโโโโโโโโโโ   โโโโโโโโโโโ   โโโโโโโโโโโ            โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### Level 2: Container

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    Container Diagram                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  โโโโโโโโโโโโ                                               โ
โ  โ Passengerโ                                               โ
โ  โ  Mobile  โ                                               โ
โ  โ   App    โ                                               โ
โ  โโโโโโฌโโโโโโ                                               โ
โ       โ HTTPS                                               โ
โ       โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ  โ         API Gateway (Kong/AWS)          โ               โ
โ  โ    [Load Balancer, Auth, Rate Limit]    โ               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ       โ                                                     โ
โ       โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโ              โ
โ       โผ                  โผ                  โผ              โ
โ  โโโโโโโโโโโโ      โโโโโโโโโโโโ      โโโโโโโโโโโโ         โ
โ  โReservationโ      โ Payment  โ      โ Inventoryโ         โ
โ  โ Service   โ      โ Service  โ      โ Service  โ         โ
โ  โ [PHP]     โ      โ [PHP]    โ      โ [PHP]    โ         โ
โ  โโโโโโฌโโโโโโโ      โโโโโโฌโโโโโโโ      โโโโโโฌโโโโโโโ         โ
โ       โ                  โ                  โ                โ
โ       โผ                  โผ                  โผ                โ
โ  โโโโโโโโโโโโ      โโโโโโโโโโโโ      โโโโโโโโโโโโ         โ
โ  โReservationโ      โ Payment  โ      โ Inventoryโ         โ
โ  โ   DB      โ      โ   DB     โ      โ   DB     โ         โ
โ  โ[PostgreSQL]โ      โ[PostgreSQL]โ      โ[PostgreSQL]โ         โ
โ  โโโโโโโโโโโโ      โโโโโโโโโโโโ      โโโโโโโโโโโโ         โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ  โ      Message Bus (Apache Kafka)         โ               โ
โ  โ    [Events, Async Processing]           โ               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### Level 3: Component

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              Component Diagram: Reservation Service         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ              Reservation Service                     โ   โ
โ  โ                  [PHP/Laravel]                       โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค   โ
โ  โ                                                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ Reservation  โ    โ   ChangeSeat โ              โ   โ
โ  โ  โ  Controller  โ    โ   Controller โ              โ   โ
โ  โ  โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ              โ   โ
โ  โ         โ                   โ                      โ   โ
โ  โ         โผ                   โผ                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ  BookFlight  โ    โ  ChangeSeat  โ              โ   โ
โ  โ  โ   Use Case   โ    โ   Use Case   โ              โ   โ
โ  โ  โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ              โ   โ
โ  โ         โ                   โ                      โ   โ
โ  โ         โผ                   โผ                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ Reservation  โ    โ   Pricing    โ              โ   โ
โ  โ  โ  Aggregate   โ    โ   Service    โ              โ   โ
โ  โ  โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ              โ   โ
โ  โ         โ                   โ                      โ   โ
โ  โ         โผ                   โผ                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ Reservation  โ    โ   Flight     โ              โ   โ
โ  โ  โ  Repository  โ    โ   Inventory  โ              โ   โ
โ  โ  โ  (Interface) โ    โ   (Interface)โ              โ   โ
โ  โ  โโโโโโโโฌโโโโโโโโ    โโโโโโโโฌโโโโโโโโ              โ   โ
โ  โ         โ                   โ                      โ   โ
โ  โ         โผ                   โผ                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ   Doctrine   โ    โ   External   โ              โ   โ
โ  โ  โRepositoryImplโ    โ   API Client โ              โ   โ
โ  โ  โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ              โ   โ
โ  โ                                                      โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Sequence Diagram: ุญุฌุฒ ุฑุญูุฉ

```
โโโโโโโโโโ  โโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโ
โPassengerโ  โMobileAppโ  โAPI Gateway  โ  โReservationโ  โInventory โ  โPayment  โ
โโโโโโฌโโโโ  โโโโโโฌโโโโโ  โโโโโโโโฌโโโโโโโ  โโโโโโฌโโโโโ  โโโโโโฌโโโโโโ  โโโโโโฌโโโโโ
     โ           โ              โ              โ            โ             โ
     โ 1. ุจุญุซ    โ              โ              โ            โ             โ
     โโโโโโโโโโโโถโ              โ              โ            โ             โ
     โ           โ 2. ุทูุจ ุจุญุซ   โ              โ            โ             โ
     โ           โโโโโโโโโโโโโโโถโ              โ            โ             โ
     โ           โ              โ 3. ุงุณุชุนูุงู   โ            โ             โ
     โ           โ              โโโโโโโโโโโโโโโถโ            โ             โ
     โ           โ              โ              โ 4. ุงูุชุญูู  โ             โ
     โ           โ              โ              โโโโโโโโโโโโโถโ             โ
     โ           โ              โ              โ 5. ุงููุชุงุฆุฌ โ             โ
     โ           โ              โ              โโโโโโโโโโโโโโ             โ
     โ           โ              โ 6. ุงููุชุงุฆุฌ   โ            โ             โ
     โ           โ              โโโโโโโโโโโโโโโโ            โ             โ
     โ           โ 7. ุนุฑุถ       โ              โ            โ             โ
     โโโโโโโโโโโโโ              โ              โ            โ             โ
     โ           โ              โ              โ            โ             โ
     โ 8. ุงุฎุชูุงุฑ โ              โ              โ            โ             โ
     โโโโโโโโโโโโถโ              โ              โ            โ             โ
     โ           โ 9. ุญุฌุฒ       โ              โ            โ             โ
     โ           โโโโโโโโโโโโโโโถโ              โ            โ             โ
     โ           โ              โ 10. ุชูููุฐ    โ            โ             โ
     โ           โ              โโโโโโโโโโโโโโโถโ            โ             โ
     โ           โ              โ              โ 11. ุญุฌุฒ ููุนุฏโ            โ
     โ           โ              โ              โโโโโโโโโโโโโถโ             โ
     โ           โ              โ              โ 12. ุชู ุงูุญุฌุฒโ            โ
     โ           โ              โ              โโโโโโโโโโโโโโ             โ
     โ           โ              โ              โ 13. ุฏูุน    โ             โ
     โ           โ              โ              โโโโโโโโโโโโโโโโโโโโโโโโโถโ
     โ           โ              โ              โ 14. ูุฌุงุญ   โ             โ
     โ           โ              โ              โโโโโโโโโโโโโโโโโโโโโโโโโโ
     โ           โ              โ              โ 15. ุชุฃููุฏ  โ             โ
     โ           โ              โ              โโโโโโโโโโโโโถโ             โ
     โ           โ              โ 16. ุชุฃููุฏ    โ            โ             โ
     โ           โ              โโโโโโโโโโโโโโโโ            โ             โ
     โ           โ 17. ุชุฃููุฏ    โ              โ            โ             โ
     โโโโโโโโโโโโโ              โ              โ            โ             โ
     โ           โ              โ              โ            โ             โ
```

### State Machine: ุญุงูุฉ ุงูุญุฌุฒ

```
                    โโโโโโโโโโโโโโโ
                    โ   START     โ
                    โโโโโโโโฌโโโโโโโ
                           โ create()
                           โผ
                    โโโโโโโโโโโโโโโ
         โโโโโโโโโโโ   PENDING   โโโโโโโโโโโ
         โ         โ             โ         โ
         โ         โโโโโโโโฌโโโโโโโ         โ
         โ                โ                โ
         โ   โโโโโโโโโโโโโโผโโโโโโโโโโโโโ   โ
         โ   โ            โ            โ   โ
         โ   โผ            โผ            โผ   โ
         โ  fail      confirm()    cancel()
         โ   โ            โ            โ   โ
         โ   โ            โผ            โ   โ
         โ   โ    โโโโโโโโโโโโโโโ      โ   โ
         โ   โ    โ  CONFIRMED  โโโโโโโโ   โ
         โ   โ    โ             โ cancel() โ
         โ   โ    โโโโโโโโฌโโโโโโโ          โ
         โ   โ           โ                 โ
         โ   โ     checkIn()               โ
         โ   โ           โ                 โ
         โ   โ           โผ                 โ
         โ   โ    โโโโโโโโโโโโโโโ          โ
         โ   โโโโโถโ   CHECKED   โ          โ
         โ        โ     IN      โ          โ
         โ        โโโโโโโโฌโโโโโโโ          โ
         โ               โ board()         โ
         โ               โผ                 โ
         โ        โโโโโโโโโโโโโโโ          โ
         โ        โ   BOARDED   โ          โ
         โ        โโโโโโโโฌโโโโโโโ          โ
         โ               โ complete()      โ
         โ               โผ                 โ
         โ        โโโโโโโโโโโโโโโ          โ
         โโโโโโโโโถโ  COMPLETED  โ          โ
                  โ             โโโโโโโโโโโโ
                  โโโโโโโโโโโโโโโ
```

---

## 2.31 ูุงุฆูุฉ ุงูุชุญูู ุงูุดุงููุฉ

### ูุจู ุงูุจุฏุก

#### ุงููุณู 1: ููู ุงููุดููุฉ
- [ ] ูู ุญุฏุฏุช ุงููุดููุฉ ุงูุญููููุฉุ
- [ ] ูู ุฌุฑุจุช ุญูููุงู ุฃุจุณุทุ
- [ ] ูู ูุณุช ุงูุชุฃุซูุฑุ

#### ุงููุณู 2: ููู ุงููุฌุงู
- [ ] ูู ุฃุฌุฑูุช Event Stormingุ
- [ ] ูู ุญุฏุฏุช Bounded Contextsุ
- [ ] ูู ุญุฏุฏุช ุงููุบุฉ ุงููุดุชุฑูุฉุ

#### ุงููุณู 3: ุงูุชุฎุทูุท
- [ ] ูู ุฑุณูุช Context Mapุ
- [ ] ูู ุญุฏุฏุช ููุงุท ุงูุชูุงููุ
- [ ] ูู ุฎุทุทุช ูุงุณุชุฑุงุชูุฌูุฉ ุงูุจูุงูุงุชุ

### ุฃุซูุงุก ุงูุชูููุฐ

#### ุงููุณู 4: ุงูุจููุฉ
- [ ] ูู ุงุชุจุนุช ูุจุงุฏุฆ SOLIDุ
- [ ] ูู ูุตูุช Domain ุนู Infrastructureุ
- [ ] ูู ุจููุช Anti-Corruption Layersุ

#### ุงููุณู 5: ุงูุฌูุฏุฉ
- [ ] ูู ูุชุจุช ุงุฎุชุจุงุฑุงุช ูุญุฏุฉุ
- [ ] ูู ูุชุจุช ุงุฎุชุจุงุฑุงุช ุชูุงููุ
- [ ] ูู ูุชุจุช Contract Testsุ
- [ ] ูู ุงูุชุบุทูุฉ > 80%ุ

#### ุงููุณู 6: ุงูุชุดุบูู
- [ ] ูู ุฃุถูุช Health Checksุ
- [ ] ูู ุฃุถูุช Metricsุ
- [ ] ูู ุฃุถูุช Distributed Tracingุ
- [ ] ูู ุฃุถูุช Logging ููุงุณุจุ

### ุจุนุฏ ุงูุฅุทูุงู

#### ุงููุณู 7: ุงููุฑุงูุจุฉ
- [ ] ูู ุชุฑุงูุจ Error Rateุ
- [ ] ูู ุชุฑุงูุจ Latencyุ
- [ ] ูู ุชุฑุงูุจ Throughputุ
- [ ] ูู ุชุฑุงูุจ Saturationุ

#### ุงููุณู 8: ุงูุชุญุณูู
- [ ] ูู ุฑุงุฌุนุช ุงูุฃุฏุงุกุ
- [ ] ูู ุฑุงุฌุนุช ุงูุชูููุฉุ
- [ ] ูู ุฑุงุฌุนุช ุฃูุงู ุงููุธุงูุ

---

## 2.32 ุฎุทูุท ุงูุฃูุงุจูุจ CI/CD

### Pipeline ูุงูู

```yaml
# .github/workflows/main.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  # 1. ุงูุจูุงุก ูุงูุงุฎุชุจุงุฑ
  build-and-test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: test_db
          POSTGRES_USER: postgres
          POSTGRES_PASSWORD: postgres
      kafka:
        image: confluentinc/cp-kafka:latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'
          extensions: pdo_pgsql, redis
      
      - name: Install Dependencies
        run: composer install --no-interaction --prefer-dist
      
      - name: Run Static Analysis
        run: |
          vendor/bin/phpstan analyse --level=9
          vendor/bin/psalm --show-info=false
      
      - name: Run Unit Tests
        run: vendor/bin/phpunit --testsuite unit --coverage-clover coverage.xml
      
      - name: Run Integration Tests
        run: vendor/bin/phpunit --testsuite integration
      
      - name: Run Contract Tests
        run: vendor/bin/phpunit --testsuite contract
      
      - name: Upload Coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage.xml
          fail_ci_if_error: true

  # 2. ูุญุต ุงูุฃูุงู
  security:
    runs-on: ubuntu-latest
    needs: build-and-test
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Composer Audit
        run: composer audit
      
      - name: Run SAST
        uses: returntocorp/semgrep-action@v1
        with:
          config: >-
            p/security-audit
            p/owasp-top-ten
      
      - name: Check for Secrets
        uses: trufflesecurity/trufflehog@main
        with:
          path: ./
          base: main

  # 3. ุจูุงุก ุงูุตูุฑุฉ
  build-image:
    runs-on: ubuntu-latest
    needs: [build-and-test, security]
    if: github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Build Docker Image
        run: |
          docker build -t myapp:${{ github.sha }} .
          docker tag myapp:${{ github.sha }} myapp:latest
      
      - name: Push to Registry
        run: |
          echo ${{ secrets.DOCKER_PASSWORD }} | docker login -u ${{ secrets.DOCKER_USERNAME }} --password-stdin
          docker push myapp:${{ github.sha }}

  # 4. ุงููุดุฑ
  deploy:
    runs-on: ubuntu-latest
    needs: build-image
    environment: production
    
    steps:
      - name: Deploy to Kubernetes
        run: |
          kubectl set image deployment/reservation-service \
            reservation-service=myapp:${{ github.sha }}
          kubectl rollout status deployment/reservation-service
      
      - name: Run Smoke Tests
        run: |
          sleep 30
          curl -f http://api.example.com/health
          curl -f http://api.example.com/ready
```

### Dockerfile ูุญุณู

```dockerfile
# Stage 1: Dependencies
FROM composer:2 AS vendor
WORKDIR /app
COPY composer.json composer.lock ./
RUN composer install --no-dev --no-interaction --prefer-dist --optimize-autoloader

# Stage 2: Application
FROM php:8.2-fpm-alpine AS app

# Install extensions
RUN apk add --no-cache \
    postgresql-dev \
    && docker-php-ext-install pdo_pgsql opcache

# Copy application
WORKDIR /var/www
COPY --from=vendor /app/vendor ./vendor
COPY . .

# Optimize
RUN php artisan optimize
RUN php artisan config:cache
RUN php artisan route:cache

# Security
RUN adduser -D -u 1000 www-data
USER www-data

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD php artisan health:check || exit 1

EXPOSE 9000
CMD ["php-fpm"]
```

---

